============================= test session starts =============================
platform win32 -- Python 3.12.8, pytest-9.0.1, pluggy-1.6.0
rootdir: c:\Users\Micro\Documents\Visual Studio\robo_sistema.binace.api
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.12.0, asyncio-1.3.0, cov-7.0.0, mock-3.15.1
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function

----------------------------- live log collection -----------------------------
2025-12-19 22:27:15 [WARNING] root: \u26a0\ufe0f Config n\xe3o carregado (cannot import name 'ORDERBOOK_CIRCUIT_BREAKER_FAILURE_THRESHOLD' from 'config' (C:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\config.py)), usando valores seguros\n2025-12-19 22:27:19 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 3}
2025-12-19 22:27:19 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 3}
collected 466 items

tests/test_ai_analyzer_mock.py::test_ai_analyzer_mock_mode 
-------------------------------- live log call --------------------------------
2025-12-19 22:27:19 [INFO] root: ================================================================================
2025-12-19 22:27:19 [INFO] root: \U0001f550 TIMEMANAGER v2.1.2 - INICIALIZANDO\n2025-12-19 22:27:19 [INFO] root:    Tempo local:     1766194039258 ms
2025-12-19 22:27:19 [INFO] root:    Timezone UTC:    UTC
2025-12-19 22:27:19 [INFO] root:    Timezone NY:     America/New_York
2025-12-19 22:27:19 [INFO] root:    Timezone SP:     America/Sao_Paulo
2025-12-19 22:27:19 [INFO] root:    ZoneInfo:        \u2705 Dispon\xedvel\n2025-12-19 22:27:19 [INFO] root:    Max offset:      600 ms
2025-12-19 22:27:19 [INFO] root:    Sync samples:    5
2025-12-19 22:27:19 [INFO] root:    Sync interval:   1800 s (30 min)
2025-12-19 22:27:19 [INFO] root: \U0001f504 Tentativa 1/3\n2025-12-19 22:27:19 [INFO] root: \U0001f504 Iniciando sincroniza\xe7\xe3o com Binance (5 amostras)...\n2025-12-19 22:27:25 [INFO] root: \u2705 Melhor amostra selecionada: RTT=1195ms, Offset=-1147ms\n2025-12-19 22:27:25 [WARNING] root: \u26a0\ufe0f Offset 1147ms > 600ms (tentativa 1/3)\n2025-12-19 22:27:25 [INFO] root: \U0001f504 Tentando re-sincroniza\xe7\xe3o...\n2025-12-19 22:27:25 [INFO] root: \U0001f504 Iniciando sincroniza\xe7\xe3o com Binance (5 amostras)...\n2025-12-19 22:27:32 [INFO] root: \u2705 Melhor amostra selecionada: RTT=1192ms, Offset=-1147ms\n2025-12-19 22:27:32 [WARNING] root: \u26a0\ufe0f Offset 1147ms > 600ms (tentativa 2/3)\n2025-12-19 22:27:32 [INFO] root: \U0001f504 Tentando re-sincroniza\xe7\xe3o...\n2025-12-19 22:27:32 [INFO] root: \U0001f504 Iniciando sincroniza\xe7\xe3o com Binance (5 amostras)...\n2025-12-19 22:27:38 [INFO] root: \u2705 Melhor amostra selecionada: RTT=1194ms, Offset=-1146ms\n2025-12-19 22:27:38 [WARNING] root: \u26a0\ufe0f Offset 1146ms > 600ms (tentativa 3/3)\n2025-12-19 22:27:38 [INFO] root: \U0001f504 Tentando re-sincroniza\xe7\xe3o...\n2025-12-19 22:27:38 [INFO] root: \U0001f504 Iniciando sincroniza\xe7\xe3o com Binance (5 amostras)...\n2025-12-19 22:27:45 [INFO] root: \u2705 Melhor amostra selecionada: RTT=1207ms, Offset=-1143ms\n2025-12-19 22:27:45 [ERROR] root: \u274c Offset 1143ms muito alto e n\xe3o corrig\xedvel.\n2025-12-19 22:27:45 [ERROR] root:    Sistema continuará mas pode haver problemas.
2025-12-19 22:27:45 [WARNING] root: \u26a0\ufe0f Re-sync n\xe3o melhorou: -1146ms \u2192 -1143ms\n2025-12-19 22:27:45 [WARNING] root: \u26a0\ufe0f Re-sync n\xe3o melhorou: -1147ms \u2192 -1143ms\n2025-12-19 22:27:45 [INFO] root: \u2705 Sincroniza\xe7\xe3o bem-sucedida na tentativa 1\n2025-12-19 22:27:45 [INFO] root: 
2025-12-19 22:27:45 [INFO] root: \U0001f50d DIAGN\xd3STICO DO SISTEMA DE TEMPO\n2025-12-19 22:27:45 [INFO] root: --------------------------------------------------------------------------------
2025-12-19 22:27:45 [INFO] root: \u23f0 Timestamps:\n2025-12-19 22:27:45 [INFO] root:    Local time (ms):  1766194065210
2025-12-19 22:27:45 [INFO] root:    Synced time (ms): 1766194064068
2025-12-19 22:27:45 [INFO] root:    Current offset:   -1142 ms (-1.14s)
2025-12-19 22:27:45 [INFO] root: \U0001f30d Timezones:\n2025-12-19 22:27:45 [INFO] root:    UTC: 2025-12-20 01:27:45 UTC
2025-12-19 22:27:45 [INFO] root:    NY:  2025-12-19 20:27:45 EST
2025-12-19 22:27:45 [INFO] root:    SP:  2025-12-19 22:27:45 -03
2025-12-19 22:27:45 [INFO] root:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:27:45 [INFO] root:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:27:45 [INFO] root:    \u2705 Offset NY correto: -5.0 horas\n2025-12-19 22:27:45 [INFO] root:    \u2705 Offset SP correto: -3.0 horas\n2025-12-19 22:27:45 [INFO] root: \U0001f4ca Estat\xedsticas de Sincroniza\xe7\xe3o:\n2025-12-19 22:27:45 [INFO] root:    Status:                ok
2025-12-19 22:27:45 [INFO] root:    Server offset:         -1143 ms
2025-12-19 22:27:45 [INFO] root:    Last RTT:              1207 ms
2025-12-19 22:27:45 [INFO] root:    Best RTT:              1192 ms
2025-12-19 22:27:45 [INFO] root:    Sync attempts:         4
2025-12-19 22:27:45 [INFO] root:    Sync failures:         0
2025-12-19 22:27:45 [INFO] root:    Auto corrections:      0
2025-12-19 22:27:45 [INFO] root:    Success rate:          100.0%
2025-12-19 22:27:45 [INFO] root:    ZoneInfo available:    \u2705 Yes\n2025-12-19 22:27:45 [INFO] root: ================================================================================
2025-12-19 22:27:45 [INFO] root: \U0001f9e0 IA Analyzer v2.3.0 inicializada - GroqCloud + Structured Output focado em regi\xf5es de entrada\n2025-12-19 22:27:45 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "mock"}
2025-12-19 22:27:45 [WARNING] root: \u26a0\ufe0f Nenhuma fonte de orderbook v\xe1lida encontrada\n2025-12-19 22:27:45 [WARNING] root: \u26a0\ufe0f Orderbook INV\xc1LIDO para prompt: bid=$0.0, ask=$0.0\n2025-12-19 22:27:45 [INFO] root: \u2705 IA [mock] analisou: Teste - BTCUSDT\n2025-12-19 22:27:45 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "mock", "model": "qwen-plus", "tipo_evento": "Teste", "ativo": "BTCUSDT"}
PASSED                                                                   [  0%]
tests/test_ai_runner.py::TestAIRunner::test_ai_runner_initialization PASSED [  0%]
tests/test_ai_runner.py::TestAIRunner::test_analyze_with_ai PASSED       [  0%]
tests/test_ai_runner.py::TestAIRunner::test_ai_runner_with_retry_success PASSED [  0%]
tests/test_ai_runner.py::TestAIRunner::test_ai_runner_with_retry_failure PASSED [  1%]
tests/test_ai_runner.py::TestAIRunner::test_ai_runner_parse_response FAILED [  1%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_initialization PASSED [  1%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_initialization_without_api_key PASSED [  1%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_config_validation PASSED [  1%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_success PASSED [  2%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_with_custom_instructions PASSED [  2%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_with_retry_success PASSED [  2%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_with_retry_failure PASSED [  2%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_rate_limited PASSED [  3%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_timeout PASSED [  3%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_orderbook_circuit_breaker_open PASSED [  3%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_prepare_prompt PASSED [  3%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_prepare_prompt_with_minimal_data PASSED [  3%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_parse_ai_response_valid_json PASSED [  4%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_parse_ai_response_invalid_json PASSED [  4%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_parse_ai_response_missing_fields PASSED [  4%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_parse_ai_response_with_json_in_text PASSED [  4%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_validate_signal PASSED [  4%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_ai_runner_parse_response PASSED [  5%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_batch_analysis FAILED [  5%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_model_parameter_validation PASSED [  5%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_streaming_analysis FAILED [  5%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_streaming_analysis_error PASSED [  6%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_cost_calculation PASSED [  6%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_cache_mechanism FAILED [  6%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_hash_orderbook_consistency PASSED [  6%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_with_fallback_success PASSED [  6%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_with_fallback_both_fail PASSED [  7%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_analyze_with_fallback_no_fallback PASSED [  7%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_prompt_template_management PASSED [  7%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_get_performance_metrics_comprehensive PASSED [  7%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_get_error_statistics PASSED [  7%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_health_check PASSED [  8%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.95-VERY_HIGH] PASSED [  8%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.9-VERY_HIGH] PASSED [  8%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.85-HIGH] PASSED [  8%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.8-HIGH] PASSED [  9%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.75-HIGH] PASSED [  9%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.7-MEDIUM] PASSED [  9%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.65-MEDIUM] PASSED [  9%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.6-MEDIUM] PASSED [  9%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.55-LOW] PASSED [ 10%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.5-LOW] PASSED [ 10%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.45-LOW] PASSED [ 10%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.4-LOW] PASSED [ 10%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.35-VERY_LOW] PASSED [ 10%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.2-VERY_LOW] PASSED [ 11%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[1.0-VERY_HIGH] PASSED [ 11%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_confidence_interpretation[0.0-VERY_LOW] PASSED [ 11%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_switch_model FAILED [ 11%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_concurrent_requests_handling PASSED [ 12%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_circuit_breaker_logic PASSED [ 12%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_compress_for_context PASSED [ 12%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_generate_cache_key_consistency PASSED [ 12%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_error_handling_and_logging PASSED [ 12%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_performance_monitoring_under_load PASSED [ 13%]
tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_comprehensive_integration_scenario PASSED [ 13%]
tests/test_circuit_breaker.py::test_circuit_breaker_opens_and_blocks_then_recovers 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] root: CircuitBreaker[t] closed -> open
2025-12-19 22:28:00 [WARNING] root: CircuitBreaker[t] open -> half_open
2025-12-19 22:28:00 [WARNING] root: CircuitBreaker[t] half_open -> closed
PASSED                                                                   [ 13%]
tests/test_circuit_breaker.py::test_half_open_failure_goes_back_to_open 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] root: CircuitBreaker[t2] closed -> open
2025-12-19 22:28:00 [WARNING] root: CircuitBreaker[t2] open -> half_open
2025-12-19 22:28:00 [WARNING] root: CircuitBreaker[t2] half_open -> open
PASSED                                                                   [ 13%]
tests/test_data_pipeline.py::test_pipeline_initialization 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=6.82 | rate=1/ms\nPASSED                                                                   [ 13%]
tests/test_data_pipeline.py::test_pipeline_insufficient_data 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] pipeline.validation.BTCUSDT: \u26a0\ufe0f Valida\xe7\xe3o vetorizada falhou: Dados insuficientes: 1 trades v\xe1lidos (m\xednimo: 2, recebidos: 1) | fallback=loop\n2025-12-19 22:28:00 [ERROR] pipeline.runtime.BTCUSDT: \u274c Erro ao carregar trades: Dados insuficientes: 1 trades v\xe1lidos (m\xednimo: 2, recebidos: 1)\nTraceback (most recent call last):\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 295, in validate_batch\n    df, stats = self._validate_vectorized(trades, min_trades)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 118, in _validate_vectorized\n    raise ValueError(\nValueError: Dados insuficientes: 1 trades v\xe1lidos (m\xednimo: 2, recebidos: 1)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\pipeline.py", line 159, in _load_trades\n    self.df, validation_stats = self._validator.validate_batch(\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 302, in validate_batch\n    df, stats = self._validate_loop(trades, min_trades)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 206, in _validate_loop\n    raise ValueError(\nValueError: Dados insuficientes: 1 trades v\xe1lidos (m\xednimo: 2, recebidos: 1)\nPASSED                                                                   [ 14%]
tests/test_data_pipeline.py::test_pipeline_empty_data 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] pipeline.validation.BTCUSDT: \u26a0\ufe0f Valida\xe7\xe3o vetorizada falhou: Lista de trades vazia | fallback=loop\n2025-12-19 22:28:00 [ERROR] pipeline.runtime.BTCUSDT: \u274c Erro ao carregar trades: Lista de trades vazia\nTraceback (most recent call last):\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 295, in validate_batch\n    df, stats = self._validate_vectorized(trades, min_trades)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 82, in _validate_vectorized\n    raise ValueError("Lista de trades vazia")\nValueError: Lista de trades vazia\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\pipeline.py", line 159, in _load_trades\n    self.df, validation_stats = self._validator.validate_batch(\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 302, in validate_batch\n    df, stats = self._validate_loop(trades, min_trades)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\validation\\validator.py", line 179, in _validate_loop\n    raise ValueError("Lista de trades vazia")\nValueError: Lista de trades vazia\nPASSED                                                                   [ 14%]
tests/test_data_pipeline.py::test_enrich_metrics 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.67 | rate=1/ms\n2025-12-19 22:28:00 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Enriched gerada\nPASSED                                                                   [ 14%]
tests/test_data_pipeline.py::test_add_context 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.84 | rate=1/ms\n2025-12-19 22:28:00 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Enriched gerada\n2025-12-19 22:28:00 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Contextual gerada\nPASSED                                                                   [ 14%]
tests/test_data_pipeline.py::test_detect_signals 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.44 | rate=1/ms\n2025-12-19 22:28:00 [WARNING] root: \u26a0\ufe0f INVARIANTE VIOLADA (Delta): Buy - Sell (0.0000) != Delta Armazenado (10.0000) em BTCUSDT\n2025-12-19 22:28:00 [WARNING] root: \u26a0\ufe0f INVARIANTE VIOLADA (Vol Sum): Buy(0.0000) + Sell(0.0000) != Total(100.0000) [Diff: -100.000000] em BTCUSDT\n2025-12-19 22:28:00 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Signal gerada | signals=2\nPASSED                                                                   [ 15%]
tests/test_data_pipeline.py::test_extract_features_success 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.79 | rate=1/ms\n2025-12-19 22:28:00 [INFO] pipeline.ml.BTCUSDT: \u2705 ML features geradas | feature_count=2\nPASSED                                                                   [ 15%]
tests/test_data_pipeline.py::test_extract_features_missing_module 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.51 | rate=1/ms\n2025-12-19 22:28:00 [WARNING] pipeline.ml.BTCUSDT: \u26a0\ufe0f generate_ml_features n\xe3o dispon\xedvel\nPASSED                                                                   [ 15%]
tests/test_data_pipeline.py::test_enrich_fallback_on_error 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.85 | rate=1/ms\n2025-12-19 22:28:00 [ERROR] pipeline.runtime.BTCUSDT: \u274c Fallback completo: enrich\nTraceback (most recent call last):\n  File "c:\\Users\\Micro\\Documents\\Visual Studio\\robo_sistema.binace.api\\data_pipeline\\pipeline.py", line 232, in enrich\n    ohlc = self._metrics.calculate_ohlc(self.df)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "C:\\Users\\Micro\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py", line 1139, in __call__\n    return self._mock_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "C:\\Users\\Micro\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py", line 1143, in _mock_call\n    return self._execute_mock_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "C:\\Users\\Micro\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py", line 1198, in _execute_mock_call\n    raise effect\nException: Erro Cr\xedtico no OHLC\nPASSED                                                                   [ 15%]
tests/test_data_pipeline.py::test_get_final_features_integration 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=5 | method=vectorized | time_ms=4.56 | rate=1/ms\n2025-12-19 22:28:00 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Enriched gerada\n2025-12-19 22:28:00 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Contextual gerada\n2025-12-19 22:28:00 [INFO] pipeline.ml.BTCUSDT: \u2705 ML features geradas | feature_count=4\nPASSED                                                                   [ 15%]
tests/test_data_validator.py::test_whale_volume_exceeds_total_should_fail 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Whale sell volume excede volume total de venda
PASSED                                                                   [ 16%]
tests/test_data_validator.py::test_whale_volume_within_limits_should_pass 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Volume total inconsistente: 100.00000000 != 10.00000000 + 8.00000000
PASSED                                                                   [ 16%]
tests/test_data_validator.py::test_whale_volume_with_fluxo_continuo_bypasses_check 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Volume total inconsistente: 100.00000000 != 10.00000000 + 40.00000000
PASSED                                                                   [ 16%]
tests/test_data_validator.py::test_timestamp_future_should_be_rejected 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [ERROR] DataValidator: \u274c Timestamp principal inv\xe1lido: 2147483648000\nPASSED                                                                   [ 16%]
tests/test_data_validator.py::test_timestamp_past_should_be_rejected 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [ERROR] DataValidator: \u274c Timestamp principal inv\xe1lido: 1000000000000\nPASSED                                                                   [ 16%]
tests/test_data_validator.py::test_delta_inconsistent_should_be_corrected 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Volume total inconsistente: 100.00000000 != 10.00000000 + 6.00000000
PASSED                                                                   [ 17%]
tests/test_data_validator.py::test_delta_enriched_snapshot_also_corrected PASSED [ 17%]
tests/test_data_validator.py::test_duplicate_events_should_be_ignored PASSED [ 17%]
tests/test_data_validator.py::test_similar_but_different_events_should_pass PASSED [ 17%]
tests/test_data_validator.py::test_invalid_window_missing_timestamp_should_be_rejected 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [ERROR] DataValidator: Estrutura inválida: evento não possui nenhum campo de timestamp.
PASSED                                                                   [ 18%]
tests/test_data_validator.py::test_event_with_timestamp_utc_should_pass PASSED [ 18%]
tests/test_data_validator.py::test_precision_corrections_btc_fields 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Volume total inconsistente: 100.00000000 != 0.62345679 + 0.50000001
PASSED                                                                   [ 18%]
tests/test_data_validator.py::test_precision_whale_volumes 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Volume total inconsistente: 100.00000000 != 10.00000000 + 8.00000000
PASSED                                                                   [ 18%]
tests/test_data_validator.py::test_temporal_consistency_in_order_events PASSED [ 18%]
tests/test_data_validator.py::test_temporal_consistency_out_of_order_within_tolerance PASSED [ 19%]
tests/test_data_validator.py::test_temporal_consistency_out_of_order_exceeds_tolerance 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [ERROR] DataValidator: \u274c Inconsist\xeancia temporal SIGNIFICATIVA: diff=5000ms (atual=1733918395000, \xfaltimo=1733918400000)\nPASSED                                                                   [ 19%]
tests/test_data_validator.py::test_correction_stats_tracking 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] DataValidator: Volume total inconsistente: 100.00000000 != 10.00000000 + 6.00000000
PASSED                                                                   [ 19%]
tests/test_enrich_signal.py::test_enrich_signal_happy_path PASSED        [ 19%]
tests/test_enrich_signal.py::test_enrich_signal_discarded_when_validator_returns_empty 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:00 [WARNING] root: Evento ABSORÇÃO / Demanda Forte descartado pela validação.
PASSED                                                                   [ 19%]
tests/test_event_bus.py::test_subscribe_and_publish_single 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:00 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:00 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 20%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:01 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:01 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_multiple_subscribers 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:01 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:01 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 20%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:01 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:01 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_different_topics 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:01 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:01 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 20%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:02 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:02 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_publish_no_subscribers 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:02 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:02 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 20%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:02 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:02 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_callback_data_integrity_and_normalization 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:02 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:02 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 21%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:02 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:02 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_shutdown_behavior 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:02 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:02 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
-------------------------------- live log call --------------------------------
2025-12-19 22:28:03 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:03 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}
PASSED                                                                   [ 21%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:03 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:03 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_deduplication 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:03 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:03 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 21%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:03 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:03 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_event_bus.py::test_normalization_bypass 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:03 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:03 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 100, "dedup_window": 1}
PASSED                                                                   [ 21%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:04 [INFO] EventBus: \U0001f504 EventBus desligado\n2025-12-19 22:28:04 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_shutdown", "level": "INFO"}

tests/test_flow_analyzer.py::TestUtilFunctions::test_to_decimal_from_int PASSED [ 21%]
tests/test_flow_analyzer.py::TestUtilFunctions::test_to_decimal_from_string PASSED [ 22%]
tests/test_flow_analyzer.py::TestUtilFunctions::test_to_decimal_from_none PASSED [ 22%]
tests/test_flow_analyzer.py::TestUtilFunctions::test_to_decimal_from_float PASSED [ 22%]
tests/test_flow_analyzer.py::TestUtilFunctions::test_to_decimal_from_decimal PASSED [ 22%]
tests/test_flow_analyzer.py::TestUtilFunctions::test_to_decimal_invalid_returns_zero 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [WARNING] root: \u26a0\ufe0f Convers\xe3o falhou para invalid: [<class 'decimal.ConversionSyntax'>]\nPASSED                                                                   [ 22%]
tests/test_flow_analyzer.py::TestUISafeRoundBTC::test_invariance_basic PASSED [ 23%]
tests/test_flow_analyzer.py::TestUISafeRoundBTC::test_invariance_zero_values PASSED [ 23%]
tests/test_flow_analyzer.py::TestUISafeRoundBTC::test_invariance_large_values PASSED [ 23%]
tests/test_flow_analyzer.py::TestUISafeRoundBTC::test_invariance_negative_handling PASSED [ 23%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[-10.0-1.0-Absor\xe7\xe3o de Compra] PASSED [ 24%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[10.0-1.0-Absor\xe7\xe3o de Venda] PASSED [ 24%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[0.5-1.0-Neutra] PASSED [ 24%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[-0.5-1.0-Neutra] PASSED [ 24%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[0.0-1.0-Neutra] PASSED [ 24%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[-1.0-1.0-Neutra] PASSED [ 25%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[1.0-1.0-Neutra] PASSED [ 25%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[-1.01-1.0-Absor\xe7\xe3o de Compra] PASSED [ 25%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_por_delta[1.01-1.0-Absor\xe7\xe3o de Venda] PASSED [ 25%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_contextual_compra 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [INFO] clock_sync: \U0001f550 ClockSync iniciado (sincronizando com Binance)\n2025-12-19 22:28:04 [INFO] root: \u2705 Liquidity Heatmap v2.1.0 inicializado | Janela: 2000 trades | Threshold: 0.300%\n2025-12-19 22:28:04 [INFO] root: \u2705 FlowAnalyzer v2.4.0 inicializado | Whale threshold: 5.00 BTC | Windows: [1, 5, 15] min | Reset interval: 4.0h | Max trades: 100000 | Time budget: 500.0ms\nPASSED                                                                   [ 25%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_contextual_venda PASSED [ 26%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_contextual_neutra_movimento_normal PASSED [ 26%]
tests/test_flow_analyzer.py::TestAbsorptionClassification::test_classificar_absorcao_contextual_neutra_delta_pequeno PASSED [ 26%]
tests/test_flow_analyzer.py::TestFlowAnalyzerState::test_initial_state PASSED [ 26%]
tests/test_flow_analyzer.py::TestFlowAnalyzerState::test_process_trade_cvd_calculation 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [WARNING] root: \u26a0\ufe0f Trade atrasado: diff=-146194083233ms\nPASSED                                                                   [ 27%]
tests/test_flow_analyzer.py::TestFlowAnalyzerState::test_process_trade_whale_detection PASSED [ 27%]
tests/test_flow_analyzer.py::TestFlowAnalyzerState::test_process_trade_invalid_trade PASSED [ 27%]
tests/test_flow_analyzer.py::TestFlowAnalyzerState::test_process_trade_batch PASSED [ 27%]
tests/test_flow_analyzer.py::TestFlowAnalyzerState::test_health_check PASSED [ 27%]
tests/test_flow_analyzer.py::TestFlowMetrics::test_get_flow_metrics_structure PASSED [ 28%]
tests/test_flow_analyzer.py::TestFlowMetrics::test_get_flow_metrics_values PASSED [ 28%]
tests/test_flow_analyzer.py::TestDynamicConfig::test_update_config_whale_threshold 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [INFO] root: \u2705 Configura\xe7\xe3o atualizada para v2\nPASSED                                                                   [ 28%]
tests/test_flow_analyzer.py::TestDynamicConfig::test_update_config_invalid_value 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [ERROR] root: \u274c Erro ao atualizar configura\xe7\xe3o: Invalid whale_threshold: whale_threshold must be > 0\nPASSED                                                                   [ 28%]
tests/test_flow_analyzer.py::TestDynamicConfig::test_update_config_absorcao_eps PASSED [ 28%]
tests/test_flow_analyzer.py::TestDynamicConfig::test_update_config_guard_mode PASSED [ 29%]
tests/test_flow_analyzer.py::TestDynamicConfig::test_update_config_invalid_guard_mode 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [ERROR] root: \u274c Erro ao atualizar configura\xe7\xe3o: Invalid absorcao_guard_mode: absorcao_guard_mode must be 'off', 'warn', or 'raise'\nPASSED                                                                   [ 29%]
tests/test_institutional_alerts.py::test_process_institutional_alerts_happy_path 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [INFO] root: \U0001f514 ALERTA: Tipo: VOLATILITY_EXPANSION | N\xedvel: 101.000 | Fator: 350.00%\nPASSED                                                                   [ 29%]
tests/test_institutional_alerts.py::test_process_institutional_alerts_respects_cooldown 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:04 [INFO] root: \U0001f514 ALERTA: Tipo: SUPPLY_EXHAUSTION\nPASSED                                                                   [ 29%]
tests/test_integration_full_flow.py::TestFullTradingFlow::test_complete_trade_signal_flow 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:04 [INFO] root: \u2705 Clock Sync inicializado\n2025-12-19 22:28:04 [INFO] root: \u2705 HealthMonitor iniciado. Warning ap\xf3s 90s, Critical ap\xf3s 180s de sil\xeancio.\n2025-12-19 22:28:04 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:04 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:04 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:04 [INFO] root: FeatureStore Parquet inicializado em features
2025-12-19 22:28:04 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 500% | Wall STD: 2.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\n2025-12-19 22:28:04 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:04 [INFO] event_saver: \U0001f550 Inicializando Clock Sync...\n2025-12-19 22:28:04 [WARNING] event_saver: \u26a0\ufe0f Clock Sync: sincroniza\xe7\xe3o inicial pendente\n2025-12-19 22:28:04 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:04 [INFO] event_saver:    UTC: 2025-12-20 01:28:04 UTC
2025-12-19 22:28:04 [INFO] event_saver:    NY:  2025-12-19 20:28:04 (EST/EDT)
2025-12-19 22:28:04 [INFO] event_saver:    SP:  2025-12-19 22:28:04 (BRT)
2025-12-19 22:28:04 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:04 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:04 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:04 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:04 [INFO] root: ============================== INICIALIZANDO IA ==============================
2025-12-19 22:28:04 [INFO] root: \U0001f9e0 Tentando inicializar AI Analyzer...\n2025-12-19 22:28:04 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
2025-12-19 22:28:04 [INFO] root: \U0001f9e0 IA Analyzer v2.3.0 inicializada - GroqCloud + Structured Output focado em regi\xf5es de entrada\nFAILED                                                                   [ 30%]
tests/test_integration_full_flow.py::TestFullTradingFlow::test_flow_with_risk_rejection 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:05 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:05 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:05 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:05 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:05 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:05 [INFO] event_saver:    UTC: 2025-12-20 01:28:05 UTC
2025-12-19 22:28:05 [INFO] event_saver:    NY:  2025-12-19 20:28:05 (EST/EDT)
2025-12-19 22:28:05 [INFO] event_saver:    SP:  2025-12-19 22:28:05 (BRT)
2025-12-19 22:28:05 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:05 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:05 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:05 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:05 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
FAILED                                                                   [ 30%]
tests/test_integration_full_flow.py::TestFullTradingFlow::test_flow_with_execution_failure 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:05 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:05 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:05 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:05 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:05 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:05 [INFO] event_saver:    UTC: 2025-12-20 01:28:05 UTC
2025-12-19 22:28:05 [INFO] event_saver:    NY:  2025-12-19 20:28:05 (EST/EDT)
2025-12-19 22:28:05 [INFO] event_saver:    SP:  2025-12-19 22:28:05 (BRT)
2025-12-19 22:28:05 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:05 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:05 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:05 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:05 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
FAILED                                                                   [ 30%]
tests/test_integration_full_flow.py::TestFullTradingFlow::test_concurrent_market_data_processing 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:05 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:05 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:05 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:05 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:05 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:05 [INFO] event_saver:    UTC: 2025-12-20 01:28:05 UTC
2025-12-19 22:28:05 [INFO] event_saver:    NY:  2025-12-19 20:28:05 (EST/EDT)
2025-12-19 22:28:05 [INFO] event_saver:    SP:  2025-12-19 22:28:05 (BRT)
2025-12-19 22:28:05 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:05 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:05 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:05 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:05 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
FAILED                                                                   [ 30%]
tests/test_integration_full_flow.py::TestFullTradingFlow::test_system_health_monitoring 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:05 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:05 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:05 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:05 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:05 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:05 [INFO] event_saver:    UTC: 2025-12-20 01:28:05 UTC
2025-12-19 22:28:05 [INFO] event_saver:    NY:  2025-12-19 20:28:05 (EST/EDT)
2025-12-19 22:28:05 [INFO] event_saver:    SP:  2025-12-19 22:28:05 (BRT)
2025-12-19 22:28:05 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:05 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:05 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:05 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:05 [INFO] root: \u2705 Liquidity Heatmap v2.1.0 inicializado | Janela: 2000 trades | Threshold: 0.300%\n2025-12-19 22:28:05 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
FAILED                                                                   [ 30%]
tests/test_integration_full_flow.py::TestFullTradingFlow::test_endurance_test 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:05 [INFO] root: \u2705 Clock Sync inicializado\n2025-12-19 22:28:05 [INFO] root: \u2705 HealthMonitor iniciado. Warning ap\xf3s 90s, Critical ap\xf3s 180s de sil\xeancio.\n2025-12-19 22:28:05 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:05 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:05 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:05 [INFO] root: FeatureStore Parquet inicializado em features
2025-12-19 22:28:05 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 500% | Wall STD: 2.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\n2025-12-19 22:28:05 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:05 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:05 [INFO] event_saver:    UTC: 2025-12-20 01:28:05 UTC
2025-12-19 22:28:05 [INFO] event_saver:    NY:  2025-12-19 20:28:05 (EST/EDT)
2025-12-19 22:28:05 [INFO] event_saver:    SP:  2025-12-19 22:28:05 (BRT)
2025-12-19 22:28:05 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:05 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:05 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:05 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:05 [INFO] root: \u2705 FlowAnalyzer v2.4.0 inicializado | Whale threshold: 5.00 BTC | Windows: [1, 5, 15] min | Reset interval: 4.0h | Max trades: 100000 | Time budget: 500.0ms\n2025-12-19 22:28:05 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
FAILED                                                                   [ 31%]
tests/test_invariant_fix.py::test_invariant_fix 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:05 [INFO] pipeline.validation.BTCUSDT: \u2705 Pipeline carregado | trades=3 | method=vectorized | time_ms=14.27 | rate=0/ms\n2025-12-19 22:28:05 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Enriched gerada\n2025-12-19 22:28:05 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Contextual gerada\n2025-12-19 22:28:05 [INFO] pipeline.runtime.BTCUSDT: \u2705 Camada Signal gerada | signals=1\nPASSED                                                                   [ 31%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_initialization ERROR [ 31%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_start_and_stop ERROR [ 31%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_success ERROR [ 31%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_without_ai ERROR [ 32%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_with_ai_error ERROR [ 32%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_orchestrator_not_running ERROR [ 32%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_with_exception ERROR [ 32%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_success ERROR [ 33%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_risk_rejection ERROR [ 33%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_cooldown_active ERROR [ 33%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_execution_failure ERROR [ 33%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_with_exception ERROR [ 33%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_orchestrator_not_running ERROR [ 34%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_add_position 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:08 [INFO] root: \U0001f680 GroqCloud ATIVO | Modelo: llama-3.3-70b-versatile | Chave: gsk_wGzR2p...omic\n2025-12-19 22:28:08 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_provider_selected", "level": "INFO", "provider": "groq", "model": "llama-3.3-70b-versatile"}
2025-12-19 22:28:08 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_provider_selected", "level": "INFO", "provider": "groq", "model": "llama-3.3-70b-versatile"}
2025-12-19 22:28:08 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_provider_selected", "level": "INFO", "provider": "groq", "model": "llama-3.3-70b-versatile"}
2025-12-19 22:28:08 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_provider_selected", "level": "INFO", "provider": "groq", "model": "llama-3.3-70b-versatile"}
2025-12-19 22:28:08 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_provider_selected", "level": "INFO", "provider": "groq", "model": "llama-3.3-70b-versatile"}
ERROR                                                                    [ 34%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:08 [INFO] root: \U0001fac0 Heartbeat do m\xf3dulo 'ai' iniciado (AIAnalyzer).\nERROR [ 34%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_update_position ERROR [ 34%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_update_position_with_risk_manager ERROR [ 34%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_remove_position ERROR [ 35%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_remove_position_without_exit_price ERROR [ 35%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_portfolio_summary ERROR [ 35%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_portfolio_summary_empty ERROR [ 35%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_can_execute_trade ERROR [ 36%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_cooldown_remaining ERROR [ 36%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_check_position_limits ERROR [ 36%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_check_daily_loss_limit ERROR [ 36%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_error_state_detection ERROR [ 36%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_error_recovery ERROR [ 37%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_performance_metrics ERROR [ 37%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_update_configuration ERROR [ 37%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_serialize_state ERROR [ 37%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_deserialize_state ERROR [ 37%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_serialize_deserialize_roundtrip ERROR [ 38%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_stream ERROR [ 38%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_stream_stopped ERROR [ 38%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_emergency_stop ERROR [ 38%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_emergency_stop_no_positions ERROR [ 39%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_emergency_stop_with_trade_executor_error ERROR [ 39%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check ERROR [ 39%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check_missing_critical_components 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:11 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:11 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:11 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:11 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:11 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:11 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:11 [INFO] MLInference: \u2705 Modelo Quantitativo (XGBoost) carregado com sucesso.\n2025-12-19 22:28:11 [INFO] MLInference: \u2705 Modelo Quantitativo (XGBoost) carregado com sucesso.\n2025-12-19 22:28:11 [INFO] MLInference: \u2705 Modelo Quantitativo (XGBoost) carregado com sucesso.\n2025-12-19 22:28:11 [INFO] MLInference: \u2705 Modelo Quantitativo (XGBoost) carregado com sucesso.\n2025-12-19 22:28:11 [INFO] MLInference: \u2705 Modelo Quantitativo (XGBoost) carregado com sucesso.\nERROR                                                                    [ 39%]2025-12-19 22:28:11 [INFO] root: \U0001f916 Motor de Infer\xeancia Quantitativa (XGBoost) inicializado\n2025-12-19 22:28:12 [INFO] root: \u2705 ML Engine testado: 54.0%\n------------------------------- live log finish -------------------------------
2025-12-19 22:28:12 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}

tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check_missing_non_critical_components ------------------------------- live log setup --------------------------------
2025-12-19 22:28:12 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
2025-12-19 22:28:12 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
2025-12-19 22:28:12 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
2025-12-19 22:28:12 [INFO] root: \u2705 M\xf3dulo da IA carregado. Realizando teste de an\xe1lise...\n2025-12-19 22:28:12 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
ERROR                                                                    [ 39%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check_not_running ERROR [ 40%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_generate_analytics_report ERROR [ 40%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_generate_analytics_report_no_trades ERROR [ 40%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_generate_analytics_report_with_filtering ERROR [ 40%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_memory_usage ERROR [ 40%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_concurrent_trade_requests ERROR [ 41%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_concurrent_market_data_processing ERROR [ 41%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_integration_scenario_complete_trading_cycle ERROR [ 41%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_integration_scenario_error_recovery ERROR [ 41%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_stress_test_high_frequency_updates ERROR [ 42%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_stress_test_memory_usage_with_many_positions ERROR [ 42%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_empty_market_data ERROR [ 42%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_invalid_trade_signal ERROR [ 42%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_extreme_values ERROR [ 42%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_unicode_symbols ERROR [ 43%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_robustness_against_none_values ERROR [ 43%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_robustness_against_type_errors ERROR [ 43%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_performance_large_portfolio_operations ERROR [ 43%]
tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_performance_many_trade_history_operations ERROR [ 43%]
tests/test_orchestrator_initialization.py::test_orchestrator_initialization 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:14 [INFO] root: \u2705 Clock Sync inicializado\n2025-12-19 22:28:14 [INFO] root: \u2705 HealthMonitor iniciado. Warning ap\xf3s 90s, Critical ap\xf3s 180s de sil\xeancio.\n2025-12-19 22:28:14 [INFO] health_monitor: {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}
2025-12-19 22:28:14 [INFO] EventBus: \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\n2025-12-19 22:28:14 [INFO] event_bus: {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}
2025-12-19 22:28:14 [INFO] root: FeatureStore Parquet inicializado em features
2025-12-19 22:28:14 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 40% | Wall STD: 3.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\n2025-12-19 22:28:14 [INFO] event_saver: \u2705 SQLite EventStore inicializado com sucesso\n2025-12-19 22:28:14 [INFO] event_saver: \U0001f550 Verifica\xe7\xe3o de Timezone:\n2025-12-19 22:28:14 [INFO] event_saver:    UTC: 2025-12-20 01:28:14 UTC
2025-12-19 22:28:14 [INFO] event_saver:    NY:  2025-12-19 20:28:14 (EST/EDT)
2025-12-19 22:28:14 [INFO] event_saver:    SP:  2025-12-19 22:28:14 (BRT)
2025-12-19 22:28:14 [INFO] event_saver:    Offset NY vs UTC: -5.0 horas
2025-12-19 22:28:14 [INFO] event_saver:    Offset SP vs UTC: -3.0 horas
2025-12-19 22:28:14 [INFO] event_saver: \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\n2025-12-19 22:28:14 [INFO] ContextCollector: \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\n2025-12-19 22:28:14 [INFO] root: \u2705 Liquidity Heatmap v2.1.0 inicializado | Janela: 2000 trades | Threshold: 0.300%\n2025-12-19 22:28:14 [INFO] root: \u2705 FlowAnalyzer v2.4.0 inicializado | Whale threshold: 5.00 BTC | Windows: [1, 5, 15] min | Reset interval: 4.0h | Max trades: 100000 | Time budget: 500.0ms\n2025-12-19 22:28:14 [INFO] root: ============================== INICIALIZANDO IA ==============================
2025-12-19 22:28:14 [INFO] root: \U0001f9e0 Tentando inicializar AI Analyzer...\n2025-12-19 22:28:14 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}

------------------------------ live log teardown ------------------------------
2025-12-19 22:28:14 [INFO] root: \U0001f9e0 IA Analyzer v2.3.0 inicializada - GroqCloud + Structured Output focado em regi\xf5es de entrada\n
tests/test_orderbook_analyze_core.py::test_analyze_with_external_valid_snapshot 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:14 [INFO] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_event", "level": "INFO", "window_id": "?", "severity": "INFO", "data_source": "external", "bid_depth_usd": 2475.0, "ask_depth_usd": 2537.5, "imbalance": -0.012468827930174564, "spread_bps": 49.8753, "emergency_mode": false}
2025-12-19 22:28:14 [INFO] root: \U0001f4ca OrderBook OK - Janela #?: bid=$2,475, ask=$2,538\nPASSED                                                                   [ 44%]
tests/test_orderbook_analyze_core.py::test_analyze_with_partial_snapshot_rejected 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:14 [ERROR] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_invalid", "level": "ERROR", "error": "validation_failed: orderbook vazio (bids=1, asks=0)", "severity": "ERROR", "fetch_errors": 0, "validation_failures": 0, "data_source": "unknown"}
PASSED                                                                   [ 44%]
tests/test_orderbook_analyze_core.py::test_analyze_when_fetch_fails_returns_invalid 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:14 [ERROR] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_invalid", "level": "ERROR", "error": "fetch_failed", "severity": "ERROR", "fetch_errors": 0, "validation_failures": 0, "data_source": "unknown"}
PASSED                                                                   [ 44%]
tests/test_orderbook_analyze_core.py::test_analyze_uses_cache_on_second_call 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:14 [INFO] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_event", "level": "INFO", "window_id": "?", "severity": "INFO", "data_source": "unknown", "bid_depth_usd": 2475.0, "ask_depth_usd": 2537.5, "imbalance": -0.012468827930174564, "spread_bps": 49.8753, "emergency_mode": false}
2025-12-19 22:28:14 [INFO] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_event", "level": "INFO", "window_id": "?", "severity": "INFO", "data_source": "unknown", "bid_depth_usd": 2475.0, "ask_depth_usd": 2537.5, "imbalance": -0.012468827930174564, "spread_bps": 49.8753, "emergency_mode": false}
PASSED                                                                   [ 45%]
tests/test_orderbook_analyzer.py::test_validate_snapshot_success 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:14 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 4000% | Wall STD: 3.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\nPASSED                                                                   [ 45%]
tests/test_orderbook_analyzer.py::test_validate_snapshot_stale_data PASSED [ 45%]
tests/test_orderbook_analyzer.py::test_validate_snapshot_crossed_spread PASSED [ 45%]
tests/test_orderbook_analyzer.py::test_validate_snapshot_zero_volume PASSED [ 45%]
tests/test_orderbook_analyzer.py::test_metrics_calculation PASSED        [ 46%]
tests/test_orderbook_analyzer.py::test_market_impact_simulation PASSED   [ 46%]
tests/test_orderbook_analyzer.py::test_analyze_valid_flow 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:15 [INFO] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_event", "level": "INFO", "window_id": "?", "severity": "INFO", "data_source": "external", "bid_depth_usd": 399880.0, "ask_depth_usd": 275130.0, "imbalance": 0.18481207685812062, "spread_bps": 1.9997999999999998, "emergency_mode": false}
2025-12-19 22:28:15 [INFO] root: \U0001f4ca OrderBook OK - Janela #?: bid=$399,880, ask=$275,130\nPASSED                                                                   [ 46%]
tests/test_orderbook_analyzer.py::test_analyze_critical_flags 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:15 [INFO] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_event", "level": "INFO", "window_id": "?", "severity": "CRITICAL", "data_source": "external", "bid_depth_usd": 50000000.0, "ask_depth_usd": 5001.0, "imbalance": 0.9997999800059998, "spread_bps": 1.9997999999999998, "emergency_mode": false}
2025-12-19 22:28:15 [INFO] root: \U0001f4ca OrderBook OK - Janela #?: bid=$50,000,000, ask=$5,001\nPASSED                                                                   [ 46%]
tests/test_orderbook_analyzer.py::test_analyze_fetch_failure 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:15 [ERROR] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_invalid", "level": "ERROR", "error": "fetch_failed", "severity": "ERROR", "fetch_errors": 0, "validation_failures": 0, "data_source": "unknown"}
PASSED                                                                   [ 46%]
tests/test_orderbook_analyzer.py::test_analyze_partial_data_rejection 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:15 [ERROR] orderbook_analyzer: {"symbol": "BTCUSDT", "event": "orderbook_invalid", "level": "ERROR", "error": "validation_failed: orderbook vazio (bids=3, asks=0)", "severity": "ERROR", "fetch_errors": 0, "validation_failures": 0, "data_source": "unknown"}
PASSED                                                                   [ 47%]
tests/test_orderbook_analyzer.py::test_get_stats PASSED                  [ 47%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_initialization_with_valid_config PASSED [ 47%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_initialization_with_invalid_config FAILED [ 47%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_process_orderbook_update_success ERROR [ 48%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_process_orderbook_update_with_malformed_data ERROR [ 48%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_calculate_metrics_basic ERROR [ 48%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_calculate_advanced_metrics ERROR [ 48%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_analyze_with_ai_success ERROR [ 48%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_analyze_with_ai_failure ERROR [ 49%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_detect_market_manipulation ERROR [ 49%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_volume_profile_analysis ERROR [ 49%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_order_flow_analysis 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:15 [INFO] root: \U0001f680 GroqCloud ATIVO | Modelo: llama-3.3-70b-versatile | Chave: gsk_wGzR2p...omic\n2025-12-19 22:28:15 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_provider_selected", "level": "INFO", "provider": "groq", "model": "llama-3.3-70b-versatile"}
2025-12-19 22:28:15 [INFO] root: \U0001fac0 Heartbeat do m\xf3dulo 'ai' iniciado (AIAnalyzer).\n2025-12-19 22:28:15 [INFO] MLInference: \U0001f4ca Modelo treinado com 51 features\n2025-12-19 22:28:15 [INFO] MLInference: \u2705 Modelo Quantitativo (XGBoost) carregado com sucesso.\n2025-12-19 22:28:15 [INFO] root: \U0001f916 Motor de Infer\xeancia Quantitativa (XGBoost) inicializado\nERROR                                                                    [ 49%]
------------------------------- live log finish -------------------------------
2025-12-19 22:28:15 [INFO] root: \u2705 ML Engine testado: 54.0%\n
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_market_depth_analysis ------------------------------- live log setup --------------------------------
2025-12-19 22:28:15 [INFO] root: \u2705 M\xf3dulo da IA carregado. Realizando teste de an\xe1lise...\nERROR                                                                    [ 50%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_technical_indicators ERROR [ 50%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_calculate_position_risk ERROR [ 50%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_detect_market_regime ERROR [ 50%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_generate_trading_signal ERROR [ 50%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_benchmark_performance ERROR [ 51%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_async_analysis ERROR [ 51%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_error_handling_and_recovery ERROR [ 51%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_memory_management ERROR [ 51%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_configuration_validation PASSED [ 51%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_serialization_deserialization ERROR [ 52%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[0.8-STRONG_BUY] ERROR [ 52%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[0.6-BUY] ERROR [ 52%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[0.2-NEUTRAL] ERROR [ 52%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[-0.2-NEUTRAL] ERROR [ 53%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[-0.6-SELL] ERROR [ 53%]
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}

------------------------------- live log setup --------------------------------
2025-12-19 22:28:16 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:16 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:16 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
ERROR                                                                    [ 53%]----------------------------- live log logreport ------------------------------
2025-12-19 22:28:16 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:16 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}
2025-12-19 22:28:16 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_ping_ok", "level": "INFO", "mode": "groq"}

tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_concurrent_access_safety ERROR [ 53%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_edge_cases_and_boundary_conditions ERROR [ 53%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_metric_history_tracking ERROR [ 54%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_price_history_accuracy ERROR [ 54%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_analyzer_lifecycle ERROR [ 54%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_configuration_persistence FAILED [ 54%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_technical_indicators_with_real_ta SKIPPED [ 54%]
tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_comprehensive_integration ERROR [ 55%]
tests/test_orderbook_config_injection.py::test_analyzer_uses_custom_cfg_basic 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:17 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 40% | Wall STD: 3.0x | Top N: 20 | Cache TTL: 9.0s | Max Stale: 33.0s | Rate Limit: 42 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\nPASSED                                                                   [ 55%]
tests/test_orderbook_config_injection.py::test_validate_snapshot_respects_cfg_min_depth 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:17 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 40% | Wall STD: 3.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\nPASSED                                                                   [ 55%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_initialization 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
FAILED                                                                   [ 55%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_update_with_valid_data 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:17 [INFO] root: \u2705 IA [groq] analisou: Teste de Conex\xe3o - BTCUSDT\n2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] root: \u2705 Teste da IA bem-sucedido!\n2025-12-19 22:28:17 [INFO] root: \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550 RESULTADO DO TESTE DA IA \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n2025-12-19 22:28:17 [INFO] root: {
  "sentiment": "neutral",
   "confidence": 0.0,
   "action": "wait",
   "rationale": "Falta de dados suficientes para análise confiável, incluindo dados de multi-timeframes, memória de eventos e probabilidades históricas.",
   "entry_zone": null,
   "invalidation_zone": null,
   "region_type": null
}
2025-12-19 22:28:17 [INFO] root: \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 303}
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
ERROR                                                                    [ 56%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_update_with_invalid_sequence 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] root: {
  "sentiment": "neutral",
   "confidence": 0.0,
   "action": "wait",
   "rationale": "Falta de dados suficientes para análise, incluindo dados de multi-timeframes, memória de eventos e probabilidades históricas.",
   "entry_zone": null,
   "invalidation_zone": null,
   "region_type": null
}
2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
ERROR                                                                    [ 56%]
------------------------------ live log teardown ------------------------------
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-19 22:28:17 [INFO] httpx: HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"

tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_update_with_missing_prices 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] root: {
  "sentiment": "neutral",
   "confidence": 0.0,
   "action": "wait",
   "rationale": "Falta de dados suficientes para análise confiável, incluindo dados de multi-timeframes, memória de eventos e probabilidade histórica.",
   "entry_zone": null,
   "invalidation_zone": null,
   "region_type": null
}
2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 301}
-------------------------------- live log call --------------------------------
2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
2025-12-19 22:28:17 [INFO] ai_analyzer: {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
2025-12-19 22:28:17 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
FAILED                                                                   [ 56%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_best_bid_ask ERROR [ 56%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_spread_edge_cases FAILED [ 56%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_mid_price FAILED [ 57%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_volume_at_price ERROR [ 57%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_total_volume ERROR [ 57%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_imbalance FAILED [ 57%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_weighted_average_price FAILED [ 57%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_price_levels ERROR [ 58%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_creation ERROR [ 58%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_validation ERROR [ 58%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_age_check FAILED [ 58%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_json_serialization FAILED [ 59%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_reset_orderbook ERROR [ 59%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_max_depth_enforcement ERROR [ 59%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_concurrent_updates FAILED [ 59%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_performance_benchmark FAILED [ 59%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_memory_efficiency ERROR [ 60%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_circuit_breaker_integration FAILED [ 60%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_error_handling FAILED [ 60%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_decimal_precision_handling FAILED [ 60%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-1.0-True] FAILED [ 60%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[1e-06-1.0-True] FAILED [ 61%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-1e-06-True] FAILED [ 61%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[0.0-1.0-False] FAILED [ 61%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-0.0-False] FAILED [ 61%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[-50000.0-1.0-False] FAILED [ 62%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0--1.0-False] FAILED [ 62%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[inf-1.0-False] FAILED [ 62%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-inf-False] FAILED [ 62%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[nan-1.0-False] FAILED [ 62%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-nan-False] FAILED [ 63%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_state_consistency_after_errors ERROR [ 63%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_cleanup_old_orders ERROR [ 63%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_custom_sorting_logic FAILED [ 63%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_statistics_comprehensive ERROR [ 63%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_liquidity_profile_analysis ERROR [ 64%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_market_impact_analysis ERROR [ 64%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_order_simulation ERROR [ 64%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_order_execution_updates_orderbook FAILED [ 64%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_high_frequency_updates FAILED [ 65%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_thread_safety_stress_test FAILED [ 65%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_memory_cleanup_on_reset ERROR [ 65%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_robustness_to_malformed_updates FAILED [ 65%]
tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_comprehensive_integration_scenario FAILED [ 65%]
tests/test_orderbook_helpers.py::test_to_float_list_basic FAILED         [ 66%]
tests/test_orderbook_helpers.py::test_sum_depth_usd_top_n FAILED         [ 66%]
tests/test_orderbook_helpers.py::test_simulate_market_impact_buy_and_sell PASSED [ 66%]
tests/test_orderbook_helpers.py::test_detect_walls_simple 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:22 [INFO] root: \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 40% | Wall STD: 3.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\nPASSED                                                                   [ 66%]
tests/test_orderbook_helpers.py::test_iceberg_reload_detects_increase PASSED [ 66%]
tests/test_orderbook_helpers.py::test_iceberg_reload_no_prev PASSED      [ 67%]
tests/test_orderbook_helpers.py::test_detect_anomalies_spread_jump_and_depth_drop PASSED [ 67%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_too_old FAILED [ 67%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_fresh FAILED [ 67%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_validation FAILED [ 68%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_with_invalid_data FAILED [ 68%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_serialization FAILED [ 68%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_from_json FAILED [ 68%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[1-True] FAILED [ 68%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[3-True] FAILED [ 69%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[6-False] FAILED [ 69%]
tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[10-False] FAILED [ 69%]
tests/test_orderbook_wrapper_fallback.py::test_orderbook_fallback_cache_and_deepcopy 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:22 [WARNING] root: \u26a0\ufe0f Usando orderbook em cache (age=0s) ap\xf3s 1 falhas\n2025-12-19 22:28:22 [WARNING] orderbook_wrapper: {"symbol": "BTCUSDT", "event": "orderbook_fallback_cache", "level": "WARNING", "age_seconds": 0.0, "failures": 1}
PASSED                                                                   [ 69%]
tests/test_orderbook_wrapper_fallback.py::test_orderbook_fallback_emergency_when_no_cache 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:22 [WARNING] root: \U0001f6a8 MODO EMERG\xcaNCIA: Orderbook indispon\xedvel (falhas: 1)\n2025-12-19 22:28:22 [ERROR] orderbook_wrapper: {"symbol": "BTCUSDT", "event": "orderbook_emergency_mode", "level": "ERROR", "failures": 1}
PASSED                                                                   [ 69%]
tests/test_orderbook_wrapper_fallback.py::test_orderbook_fallback_invalid_when_emergency_disabled 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:22 [ERROR] root: \u274c Orderbook totalmente indispon\xedvel (falhas consecutivas: 1)\n2025-12-19 22:28:22 [ERROR] orderbook_wrapper: {"symbol": "BTCUSDT", "event": "orderbook_fallback_error", "level": "ERROR", "failures": 1}
PASSED                                                                   [ 70%]
tests/test_orderbook_wrapper_fetch_with_retry.py::test_fetch_orderbook_with_retry_saves_success 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:22 [INFO] orderbook_wrapper: {"symbol": "BTCUSDT", "event": "orderbook_ok", "level": "INFO", "window_id": 7, "bid_depth_usd": 9999.0, "ask_depth_usd": 9999.0, "min_depth_usd": 5000.0}
PASSED                                                                   [ 70%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_initial_state 
------------------------------- live log setup --------------------------------
2025-12-19 22:28:22 [INFO] root: \u2705 Liquidity Heatmap v2.1.0 inicializado | Janela: 2000 trades | Threshold: 0.300%\n2025-12-19 22:28:22 [INFO] root: \u2705 FlowAnalyzer v2.4.0 inicializado | Whale threshold: 5.00 BTC | Windows: [1, 5, 15] min | Reset interval: 4.0h | Max trades: 100000 | Time budget: 500.0ms\nPASSED                                                                   [ 70%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_sequential_trades_no_out_of_order 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:22 [WARNING] root: \u26a0\ufe0f Trade atrasado: diff=-40000ms\nPASSED                                                                   [ 70%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_out_of_order_detection PASSED [ 71%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_all_trades_stored_despite_ooo PASSED [ 71%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_pruning_robustness_with_ooo PASSED [ 71%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_pruning_fast_path_when_ordered PASSED [ 71%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_pruning_removes_all_old PASSED [ 71%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_pruning_keeps_all_recent PASSED [ 72%]
tests/test_out_of_order_pruning.py::TestOutOfOrderPruning::test_cache_degradation_on_ooo PASSED [ 72%]
tests/test_out_of_order_pruning.py::TestEdgeCases::test_empty_prune PASSED [ 72%]
tests/test_out_of_order_pruning.py::TestEdgeCases::test_single_trade_prune_keep PASSED [ 72%]
tests/test_out_of_order_pruning.py::TestEdgeCases::test_single_trade_prune_remove PASSED [ 72%]
tests/test_out_of_order_pruning.py::TestEdgeCases::test_same_timestamp_trades PASSED [ 73%]
tests/test_out_of_order_pruning.py::TestEdgeCases::test_trades_at_cutoff_boundary PASSED [ 73%]
tests/test_out_of_order_pruning.py::TestCVDAfterOOO::test_cvd_correct_with_ooo_trades PASSED [ 73%]
tests/test_out_of_order_pruning.py::TestCVDAfterOOO::test_cvd_correct_after_pruning PASSED [ 73%]
tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_orderbook_update_performance PASSED [ 74%]
tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_orderbook_analyzer_performance PASSED [ 74%]
tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_market_orchestrator_throughput FAILED [ 74%]
tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_memory_usage_growth PASSED [ 74%]
tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_concurrent_performance FAILED [ 74%]
tests/test_rate_limiter.py::test_rate_limiter_blocks_when_exceeding_calls PASSED [ 75%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_initialization PASSED [ 75%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_add_position PASSED [ 75%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_update_position PASSED [ 75%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_remove_position FAILED [ 75%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_approved FAILED [ 76%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_position_limit FAILED [ 76%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_size_limit PASSED [ 76%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_daily_loss_limit PASSED [ 76%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_loss_per_trade_limit PASSED [ 77%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_calculate_position_risk_metrics FAILED [ 77%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_calculate_portfolio_risk_metrics PASSED [ 77%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_stress_testing PASSED [ 77%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_var_calculation PASSED [ 77%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_correlation_analysis PASSED [ 78%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_liquidity_risk_assessment PASSED [ 78%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_margin_requirement_calculation PASSED [ 78%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_concentration_risk PASSED [ 78%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_scenario_analysis PASSED [ 78%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_risk_adjusted_return_metrics PASSED [ 79%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_volatility_forecasting PASSED [ 79%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_counterparty_risk_assessment PASSED [ 79%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_regulatory_compliance_check PASSED [ 79%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_risk_limit_dynamic_adjustment PASSED [ 80%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_risk_report_generation PASSED [ 80%]
tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_error_handling_and_recovery FAILED [ 80%]
tests/test_rolling_aggregate.py::TestRollingAggregateInitialization::test_default_initialization PASSED [ 80%]
tests/test_rolling_aggregate.py::TestRollingAggregateInitialization::test_ohlc_initial_state PASSED [ 80%]
tests/test_rolling_aggregate.py::TestRollingAggregateInitialization::test_reset PASSED [ 81%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_add_single_buy_trade PASSED [ 81%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_add_single_sell_trade PASSED [ 81%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_add_whale_trade PASSED [ 81%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_add_non_whale_trade PASSED [ 81%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_ohlc_single_trade PASSED [ 82%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_ohlc_multiple_trades PASSED [ 82%]
tests/test_rolling_aggregate.py::TestRollingAggregateAddTrade::test_reject_out_of_order_trade PASSED [ 82%]
tests/test_rolling_aggregate.py::TestRollingAggregatePruning::test_prune_subtracts_correctly PASSED [ 82%]
tests/test_rolling_aggregate.py::TestRollingAggregatePruning::test_prune_updates_ohlc PASSED [ 83%]
tests/test_rolling_aggregate.py::TestRollingAggregatePruning::test_prune_all PASSED [ 83%]
tests/test_rolling_aggregate.py::TestRollingAggregateEviction::test_eviction_by_max_trades PASSED [ 83%]
tests/test_rolling_aggregate.py::TestRollingAggregateOHLCRecompute::test_ohlc_recompute_after_high_removed PASSED [ 83%]
tests/test_rolling_aggregate.py::TestRollingAggregateOHLCRecompute::test_ohlc_recompute_after_low_removed PASSED [ 83%]
tests/test_rolling_aggregate.py::TestRollingAggregateOHLCRecompute::test_ohlc_fallback_empty PASSED [ 84%]
tests/test_rolling_aggregate.py::TestRollingAggregateOHLCRecompute::test_ohlc_fallback_zero PASSED [ 84%]
tests/test_rolling_aggregate.py::TestRollingAggregateMetrics::test_metrics_structure PASSED [ 84%]
tests/test_rolling_aggregate.py::TestRollingAggregateMetrics::test_metrics_values PASSED [ 84%]
tests/test_rolling_aggregate.py::TestRollingAggregateMetrics::test_metrics_sector_agg PASSED [ 84%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_dataframe_success PASSED [ 85%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_dataframe_missing_columns PASSED [ 85%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_dataframe_insufficient_rows PASSED [ 85%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_dataframe_zero_or_negative_prices PASSED [ 85%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_dataframe_negative_volume PASSED [ 86%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_dataframe_nan_values PASSED [ 86%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_series_success PASSED [ 86%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_series_nan_without_permission PASSED [ 86%]
tests/test_support_resistance_consolidated.py::TestValidation::test_validate_series_nan_with_permission PASSED [ 86%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_sr_config_defaults PASSED [ 87%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_sr_config_validation_correct PASSED [ 87%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_sr_config_validation_wrong_count PASSED [ 87%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_sr_config_validation_wrong_sum PASSED [ 87%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_volume_profile_config_defaults PASSED [ 87%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_volume_profile_config_custom_values PASSED [ 88%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_institutional_config_defaults PASSED [ 88%]
tests/test_support_resistance_consolidated.py::TestConfiguration::test_monitor_config_defaults PASSED [ 88%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_initialization_default PASSED [ 88%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_initialization_custom_config PASSED [ 89%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_analyze_basic_execution 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 89%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_analyze_with_custom_config 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 89%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_analyze_constant_price 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 60, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 60, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 60, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 60, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 60, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 60, "num_levels": 5}
PASSED                                                                   [ 89%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_analyze_without_volume 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 100, "num_levels": 5}
PASSED                                                                   [ 89%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_analyze_empty_data_handling PASSED [ 90%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_levels_structure_and_scores 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 90%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_volume_profile_structure 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 90%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_confluence_analysis_structure 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 90%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_consolidated_report_structure 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 90%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_context_manager 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Sistema resetado
PASSED                                                                   [ 91%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_reset_method 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Sistema resetado
PASSED                                                                   [ 91%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_health_check 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 100, "num_levels": 3}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 100, "num_levels": 3}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 100, "num_levels": 3}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 100, "num_levels": 3}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 100, "num_levels": 3}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 100, "num_levels": 3}
PASSED                                                                   [ 91%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_create_market_monitor 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:42 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:42 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 91%]
tests/test_support_resistance_consolidated.py::TestInstitutionalSupportResistanceSystem::test_create_monitor_without_analysis PASSED [ 92%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_process_tick_no_signal PASSED [ 92%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_process_tick_near_support PASSED [ 92%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_process_tick_near_resistance PASSED [ 92%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_deque_limits PASSED [ 92%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_reset PASSED [ 93%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_update_levels PASSED [ 93%]
tests/test_support_resistance_consolidated.py::TestInstitutionalMarketMonitor::test_summary_report PASSED [ 93%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_clamp PASSED [ 93%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_safe_divide PASSED [ 93%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_confidence_interval PASSED [ 94%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_confidence_interval_empty PASSED [ 94%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_confidence_interval_single_value PASSED [ 94%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_cluster_prices PASSED [ 94%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_cache_thread_safety PASSED [ 95%]
tests/test_support_resistance_consolidated.py::TestStatisticalUtils::test_cache_clear PASSED [ 95%]
tests/test_support_resistance_consolidated.py::TestEdgeCases::test_single_row_dataframe PASSED [ 95%]
tests/test_support_resistance_consolidated.py::TestEdgeCases::test_very_small_price_range 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 100, "num_levels": 5}
PASSED                                                                   [ 95%]
tests/test_support_resistance_consolidated.py::TestEdgeCases::test_very_large_price_range 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 100, "num_levels": 5}
PASSED                                                                   [ 95%]
tests/test_support_resistance_consolidated.py::TestEdgeCases::test_extreme_volume_values 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 100, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 100, "num_levels": 5}
PASSED                                                                   [ 96%]
tests/test_support_resistance_consolidated.py::TestIntegration::test_full_pipeline 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 96%]
tests/test_support_resistance_consolidated.py::TestIntegration::test_multiple_analyses_different_configs 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 96%]
tests/test_support_resistance_consolidated.py::TestIntegration::test_system_reproducibility 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 96%]
tests/test_support_resistance_consolidated.py::TestSpecificMetrics::test_support_below_current_price 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 96%]
tests/test_support_resistance_consolidated.py::TestSpecificMetrics::test_resistance_above_current_price 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 97%]
tests/test_support_resistance_consolidated.py::TestSpecificMetrics::test_poc_in_value_area 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 97%]
tests/test_support_resistance_consolidated.py::TestSpecificMetrics::test_quality_rating_values 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] support_resistance.system: Iniciando análise institucional | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Calculando pivot points multi-timeframe... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando volume profile... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Detectando níveis de suporte e resistência... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Analisando confluência de níveis... | {"data_points": 200, "num_levels": 5}
2025-12-19 22:28:44 [INFO] support_resistance.system: Gerando relatório consolidado... | {"data_points": 200, "num_levels": 5}
PASSED                                                                   [ 97%]
tests/test_trade_flow_analyzer.py::test_initialization PASSED            [ 97%]
tests/test_trade_flow_analyzer.py::test_analyze_window_empty_data PASSED [ 98%]
tests/test_trade_flow_analyzer.py::test_analyze_window_insufficient_data PASSED [ 98%]
tests/test_trade_flow_analyzer.py::test_analyze_window_valid_execution PASSED [ 98%]
tests/test_update_histories.py::test_update_histories_appends_basic_values PASSED [ 98%]
tests/test_update_histories.py::test_update_histories_uses_volatility_5_first PASSED [ 98%]
tests/test_update_histories.py::test_update_histories_falls_back_to_volatility_1 PASSED [ 99%]
tests/test_window_processor.py::test_process_window_warmup_does_not_advance_window 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] root: \u23f3 AQUECIMENTO: Janela processada (1/3)\nPASSED                                                                   [ 99%]
tests/test_window_processor.py::test_process_window_insufficient_trades_no_buffer 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [WARNING] root: \u23f3 Janela com apenas 1 trades (m\xedn: 3). Aguardando mais dados...\nPASSED                                                                   [ 99%]
tests/test_window_processor.py::test_process_window_uses_trades_buffer_when_insufficient 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [INFO] root: \U0001f504 Recuperando 3 trades do buffer de emerg\xeancia...\n2025-12-19 22:28:44 [ERROR] ModelInference: Erro ao carregar modelo/metadados: `_estimator_type` undefined.  Please use appropriate mixin to define estimator type.
2025-12-19 22:28:44 [WARNING] ModelInference: Modelo ou feature_names não disponíveis.
2025-12-19 22:28:44 [INFO] enhanced_market_bot: {"symbol": "BTCUSDT", "event": "window_processed", "level": "INFO", "window_count": 1, "trade_count": 3, "total_volume": 6.0, "total_buy_volume": 6.0, "total_sell_volume": 0.0, "dynamic_delta_threshold": 0.0, "orderbook_source": "test", "orderbook_valid": true, "signals_count": 1}
PASSED                                                                   [ 99%]
tests/test_window_processor.py::test_process_window_happy_path_calls_process_signals_and_feature_store 
-------------------------------- live log call --------------------------------
2025-12-19 22:28:44 [ERROR] ModelInference: Erro ao carregar modelo/metadados: `_estimator_type` undefined.  Please use appropriate mixin to define estimator type.
2025-12-19 22:28:44 [WARNING] ModelInference: Modelo ou feature_names não disponíveis.
2025-12-19 22:28:44 [INFO] enhanced_market_bot: {"symbol": "BTCUSDT", "event": "window_processed", "level": "INFO", "window_count": 1, "trade_count": 3, "total_volume": 6.0, "total_buy_volume": 6.0, "total_sell_volume": 0.0, "dynamic_delta_threshold": 0.0, "orderbook_source": "live", "orderbook_valid": true, "signals_count": 1}
PASSED                                                                   [100%]
ERROR: Coverage failure: total of 36.66 is less than fail-under=65.00


=================================== ERRORS ====================================
__ ERROR at setup of TestMarketOrchestratorComprehensive.test_initialization __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
__ ERROR at setup of TestMarketOrchestratorComprehensive.test_start_and_stop __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_success _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_without_ai _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_with_ai_error _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_orchestrator_not_running _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_with_exception _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_execute_trade_flow_success _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_execute_trade_flow_risk_rejection _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_execute_trade_flow_cooldown_active _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_execute_trade_flow_execution_failure _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_execute_trade_flow_with_exception _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_execute_trade_flow_orchestrator_not_running _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
___ ERROR at setup of TestMarketOrchestratorComprehensive.test_add_position ___
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_add_position_duplicate _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
---------------------------- Captured stdout setup ----------------------------

tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_add_position_duplicate 
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_update_position __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_update_position_with_risk_manager _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_remove_position __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_remove_position_without_exit_price _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_get_portfolio_summary _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_get_portfolio_summary_empty _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_can_execute_trade _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_get_cooldown_remaining _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_check_position_limits _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_check_daily_loss_limit _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_error_state_detection _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
__ ERROR at setup of TestMarketOrchestratorComprehensive.test_error_recovery __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_get_performance_metrics _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_update_configuration _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_serialize_state __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_deserialize_state _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_serialize_deserialize_roundtrip _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_stream _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_process_market_data_stream_stopped _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
__ ERROR at setup of TestMarketOrchestratorComprehensive.test_emergency_stop __
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_emergency_stop_no_positions _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_emergency_stop_with_trade_executor_error _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
___ ERROR at setup of TestMarketOrchestratorComprehensive.test_health_check ___
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_health_check_missing_critical_components _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_health_check_missing_non_critical_components _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
---------------------------- Captured stdout setup ----------------------------

------------------------------- live log start --------------------------------
2025-12-19 22:28:12 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
----------------------------- Captured log setup ------------------------------
INFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}\nINFO     root:ai_runner.py:141 \u2705 M\xf3dulo da IA carregado. Realizando teste de an\xe1lise...\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_health_check_not_running _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_generate_analytics_report _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_generate_analytics_report_no_trades _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_generate_analytics_report_with_filtering _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
___ ERROR at setup of TestMarketOrchestratorComprehensive.test_memory_usage ___
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_concurrent_trade_requests _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_concurrent_market_data_processing _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_integration_scenario_complete_trading_cycle _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_integration_scenario_error_recovery _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_stress_test_high_frequency_updates _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_stress_test_memory_usage_with_many_positions _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_edge_case_empty_market_data _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_edge_case_invalid_trade_signal _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_edge_case_extreme_values _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_edge_case_unicode_symbols _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_robustness_against_none_values _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_robustness_against_type_errors _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_performance_large_portfolio_operations _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestMarketOrchestratorComprehensive.test_performance_many_trade_history_operations _
tests\test_market_orchestrator_comprehensive.py:1041: in orchestrator_config
    return OrchestratorConfig(
E   TypeError: OrchestratorConfig.__init__() got an unexpected keyword argument 'max_position_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_process_orderbook_update_success _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_process_orderbook_update_with_malformed_data _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_calculate_metrics_basic _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_calculate_advanced_metrics _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_analyze_with_ai_success _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_analyze_with_ai_failure _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_detect_market_manipulation _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_volume_profile_analysis _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_order_flow_analysis _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_market_depth_analysis _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
---------------------------- Captured stdout setup ----------------------------

------------------------------- live log start --------------------------------
2025-12-19 22:28:15 [INFO] ai_runner: {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}
----------------------------- Captured log setup ------------------------------
INFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ml_engine_initialized", "level": "INFO", "status": "ok"}\nINFO     root:ai_runner.py:141 \u2705 M\xf3dulo da IA carregado. Realizando teste de an\xe1lise...
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_technical_indicators _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_calculate_position_risk _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_detect_market_regime _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_generate_trading_signal _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_benchmark_performance _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
__ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_async_analysis ___
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_error_handling_and_recovery _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_memory_management _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_serialization_deserialization _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_imbalance_based_signals[0.8-STRONG_BUY] _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_imbalance_based_signals[0.6-BUY] _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_imbalance_based_signals[0.2-NEUTRAL] _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_imbalance_based_signals[-0.2-NEUTRAL] _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_imbalance_based_signals[-0.6-SELL] _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_imbalance_based_signals[-0.8-STRONG_SELL] _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
---------------------------- Captured stdout setup ----------------------------

tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[-0.8-STRONG_SELL] 
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_concurrent_access_safety _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_edge_cases_and_boundary_conditions _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_metric_history_tracking _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_price_history_accuracy _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_analyzer_lifecycle _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_ ERROR at setup of TestOrderBookAnalyzerComprehensive.test_comprehensive_integration _
tests\test_orderbook_analyzer_comprehensive.py:360: in analyzer
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
__ ERROR at setup of TestOrderBookComprehensive.test_update_with_valid_data ___
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
----------------------------- Captured log setup ------------------------------
INFO     root:ai_analyzer_qwen.py:1395 \u2705 IA [groq] analisou: Teste de Conex\xe3o - BTCUSDT\nINFO     ai_analyzer:structured_logging.py:33 {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conex\xe3o", "ativo": "BTCUSDT"}\nINFO     root:ai_runner.py:179 \u2705 Teste da IA bem-sucedido!
_ ERROR at setup of TestOrderBookComprehensive.test_update_with_invalid_sequence _
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ ERROR at setup of TestOrderBookComprehensive.test_get_best_bid_ask ______
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ ERROR at setup of TestOrderBookComprehensive.test_get_volume_at_price ____
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ ERROR at setup of TestOrderBookComprehensive.test_get_total_volume ______
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ ERROR at setup of TestOrderBookComprehensive.test_get_price_levels ______
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ ERROR at setup of TestOrderBookComprehensive.test_snapshot_creation _____
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ ERROR at setup of TestOrderBookComprehensive.test_snapshot_validation ____
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
______ ERROR at setup of TestOrderBookComprehensive.test_reset_orderbook ______
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
___ ERROR at setup of TestOrderBookComprehensive.test_max_depth_enforcement ___
tests\test_orderbook_core_comprehensive.py:640: in large_orderbook_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ ERROR at setup of TestOrderBookComprehensive.test_memory_efficiency _____
tests\test_orderbook_core_comprehensive.py:640: in large_orderbook_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_ ERROR at setup of TestOrderBookComprehensive.test_state_consistency_after_errors _
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ ERROR at setup of TestOrderBookComprehensive.test_cleanup_old_orders _____
tests\test_orderbook_core_comprehensive.py:640: in large_orderbook_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_ ERROR at setup of TestOrderBookComprehensive.test_get_statistics_comprehensive _
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_ ERROR at setup of TestOrderBookComprehensive.test_liquidity_profile_analysis _
tests\test_orderbook_core_comprehensive.py:628: in sample_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ ERROR at setup of TestOrderBookComprehensive.test_market_impact_analysis ___
tests\test_orderbook_core_comprehensive.py:640: in large_orderbook_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ ERROR at setup of TestOrderBookComprehensive.test_order_simulation ______
tests\test_orderbook_core_comprehensive.py:640: in large_orderbook_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ ERROR at setup of TestOrderBookComprehensive.test_memory_cleanup_on_reset __
tests\test_orderbook_core_comprehensive.py:640: in large_orderbook_update
    return OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
================================== FAILURES ===================================
_________________ TestAIRunner.test_ai_runner_parse_response __________________
tests\test_ai_runner.py:97: in test_ai_runner_parse_response
    assert parsed['confidence'] == 0.85
E   assert 0.5 == 0.85
________________ TestAIRunnerComprehensive.test_batch_analysis ________________
tests\test_ai_runner_comprehensive.py:1598: in test_batch_analysis
    QwenClient.set_response_sequence(responses)
E   TypeError: MockQwenClient.set_response_sequence() missing 1 required positional argument: 'sequence'
______________ TestAIRunnerComprehensive.test_streaming_analysis ______________
tests\test_ai_runner_comprehensive.py:594: in analyze_with_streaming
    raise AIAnalysisError(parsed_result['error'])
E   test_ai_runner_comprehensive.AIAnalysisError: Failed to parse AI response: Missing required field: reasoning

During handling of the above exception, another exception occurred:
tests\test_ai_runner_comprehensive.py:1718: in test_streaming_analysis
    result = await ai_runner.analyze_with_streaming(sample_market_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests\test_ai_runner_comprehensive.py:611: in analyze_with_streaming
    raise AIAnalysisError(f"Streaming analysis failed: {str(e)}")
E   test_ai_runner_comprehensive.AIAnalysisError: Streaming analysis failed: Failed to parse AI response: Missing required field: reasoning
_______________ TestAIRunnerComprehensive.test_cache_mechanism ________________
tests\test_ai_runner_comprehensive.py:1809: in test_cache_mechanism
    assert len(ai_runner.cache) == 0
E   AssertionError: assert 1 == 0
E    +  where 1 = len({'fc4c0ed859246b2de63099fbed5615d6': {'result': {'confidence': 0.8, 'signal': 'BUY'}, 'timestamp': 1766194079.7894783}})
E    +    where {'fc4c0ed859246b2de63099fbed5615d6': {'result': {'confidence': 0.8, 'signal': 'BUY'}, 'timestamp': 1766194079.7894783}} = <test_ai_runner_comprehensive.AIRunner object at 0x0000023B52E88A10>.cache
_________________ TestAIRunnerComprehensive.test_switch_model _________________
tests\test_ai_runner_comprehensive.py:2156: in test_switch_model
    assert ai_runner.max_retries == 5
E   assert 3 == 5
E    +  where 3 = <test_ai_runner_comprehensive.AIRunner object at 0x0000023B52EACB00>.max_retries
_____________ TestFullTradingFlow.test_complete_trade_signal_flow _____________
tests\test_integration_full_flow.py:89: in test_complete_trade_signal_flow
    result = await full_trading_system.execute_complete_flow(market_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EnhancedMarketBot' object has no attribute 'execute_complete_flow'
----------------------------- Captured log setup ------------------------------
INFO     root:market_orchestrator.py:151 \u2705 Clock Sync inicializado\nINFO     root:health_monitor.py:55 \u2705 HealthMonitor iniciado. Warning ap\xf3s 90s, Critical ap\xf3s 180s de sil\xeancio.\nINFO     health_monitor:structured_logging.py:33 {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}\nINFO     EventBus:event_bus.py:581 \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\nINFO     event_bus:structured_logging.py:33 {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}\nINFO     root:feature_store.py:34 FeatureStore Parquet inicializado em features\nINFO     root:orderbook_analyzer.py:398 \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 500% | Wall STD: 2.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\nINFO     event_saver:event_saver.py:352 \u2705 SQLite EventStore inicializado com sucesso\nINFO     event_saver:event_saver.py:387 \U0001f550 Inicializando Clock Sync...\nWARNING  event_saver:event_saver.py:407 \u26a0\ufe0f Clock Sync: sincroniza\xe7\xe3o inicial pendente\nINFO     event_saver:event_saver.py:440 \U0001f550 Verifica\xe7\xe3o de Timezone:\nINFO     event_saver:event_saver.py:441    UTC: 2025-12-20 01:28:04 UTC\nINFO     event_saver:event_saver.py:442    NY:  2025-12-19 20:28:04 (EST/EDT)\nINFO     event_saver:event_saver.py:443    SP:  2025-12-19 22:28:04 (BRT)\nINFO     event_saver:event_saver.py:447    Offset NY vs UTC: -5.0 horas\nINFO     event_saver:event_saver.py:450    Offset SP vs UTC: -3.0 horas\nINFO     event_saver:event_saver.py:424 \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\nINFO     ContextCollector:context_collector.py:132 \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\nINFO     root:ai_runner.py:83 ============================== INICIALIZANDO IA ==============================\nINFO     root:ai_runner.py:84 \U0001f9e0 Tentando inicializar AI Analyzer...\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}\nINFO     root:ai_analyzer_qwen.py:355 \U0001f9e0 IA Analyzer v2.3.0 inicializada - GroqCloud + Structured Output focado em regi\xf5es de entrada
______________ TestFullTradingFlow.test_flow_with_risk_rejection ______________
tests\test_integration_full_flow.py:112: in test_flow_with_risk_rejection
    result = await full_trading_system.execute_complete_flow({})
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EnhancedMarketBot' object has no attribute 'execute_complete_flow'
----------------------------- Captured log setup ------------------------------
INFO     health_monitor:structured_logging.py:33 {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}\nINFO     EventBus:event_bus.py:581 \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\nINFO     event_bus:structured_logging.py:33 {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}\nINFO     event_saver:event_saver.py:352 \u2705 SQLite EventStore inicializado com sucesso\nINFO     event_saver:event_saver.py:440 \U0001f550 Verifica\xe7\xe3o de Timezone:\nINFO     event_saver:event_saver.py:441    UTC: 2025-12-20 01:28:05 UTC\nINFO     event_saver:event_saver.py:442    NY:  2025-12-19 20:28:05 (EST/EDT)\nINFO     event_saver:event_saver.py:443    SP:  2025-12-19 22:28:05 (BRT)\nINFO     event_saver:event_saver.py:447    Offset NY vs UTC: -5.0 horas\nINFO     event_saver:event_saver.py:450    Offset SP vs UTC: -3.0 horas\nINFO     event_saver:event_saver.py:424 \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\nINFO     ContextCollector:context_collector.py:132 \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
____________ TestFullTradingFlow.test_flow_with_execution_failure _____________
tests\test_integration_full_flow.py:125: in test_flow_with_execution_failure
    result = await full_trading_system.execute_complete_flow({})
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EnhancedMarketBot' object has no attribute 'execute_complete_flow'
----------------------------- Captured log setup ------------------------------
INFO     health_monitor:structured_logging.py:33 {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}\nINFO     EventBus:event_bus.py:581 \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\nINFO     event_bus:structured_logging.py:33 {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}\nINFO     event_saver:event_saver.py:352 \u2705 SQLite EventStore inicializado com sucesso\nINFO     event_saver:event_saver.py:440 \U0001f550 Verifica\xe7\xe3o de Timezone:\nINFO     event_saver:event_saver.py:441    UTC: 2025-12-20 01:28:05 UTC\nINFO     event_saver:event_saver.py:442    NY:  2025-12-19 20:28:05 (EST/EDT)\nINFO     event_saver:event_saver.py:443    SP:  2025-12-19 22:28:05 (BRT)\nINFO     event_saver:event_saver.py:447    Offset NY vs UTC: -5.0 horas\nINFO     event_saver:event_saver.py:450    Offset SP vs UTC: -3.0 horas\nINFO     event_saver:event_saver.py:424 \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\nINFO     ContextCollector:context_collector.py:132 \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
_________ TestFullTradingFlow.test_concurrent_market_data_processing __________
tests\test_integration_full_flow.py:152: in test_concurrent_market_data_processing
    await asyncio.gather(*tasks)
tests\test_integration_full_flow.py:147: in process_stream
    result = await full_trading_system.process_market_data(data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EnhancedMarketBot' object has no attribute 'process_market_data'
----------------------------- Captured log setup ------------------------------
INFO     health_monitor:structured_logging.py:33 {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}\nINFO     EventBus:event_bus.py:581 \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\nINFO     event_bus:structured_logging.py:33 {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}\nINFO     event_saver:event_saver.py:352 \u2705 SQLite EventStore inicializado com sucesso\nINFO     event_saver:event_saver.py:440 \U0001f550 Verifica\xe7\xe3o de Timezone:\nINFO     event_saver:event_saver.py:441    UTC: 2025-12-20 01:28:05 UTC\nINFO     event_saver:event_saver.py:442    NY:  2025-12-19 20:28:05 (EST/EDT)\nINFO     event_saver:event_saver.py:443    SP:  2025-12-19 22:28:05 (BRT)\nINFO     event_saver:event_saver.py:447    Offset NY vs UTC: -5.0 horas\nINFO     event_saver:event_saver.py:450    Offset SP vs UTC: -3.0 horas\nINFO     event_saver:event_saver.py:424 \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\nINFO     ContextCollector:context_collector.py:132 \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
______________ TestFullTradingFlow.test_system_health_monitoring ______________
tests\test_integration_full_flow.py:165: in test_system_health_monitoring
    system_health = full_trading_system.check_system_health()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EnhancedMarketBot' object has no attribute 'check_system_health'
----------------------------- Captured log setup ------------------------------
INFO     health_monitor:structured_logging.py:33 {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}\nINFO     EventBus:event_bus.py:581 \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\nINFO     event_bus:structured_logging.py:33 {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}\nINFO     event_saver:event_saver.py:352 \u2705 SQLite EventStore inicializado com sucesso\nINFO     event_saver:event_saver.py:440 \U0001f550 Verifica\xe7\xe3o de Timezone:\nINFO     event_saver:event_saver.py:441    UTC: 2025-12-20 01:28:05 UTC\nINFO     event_saver:event_saver.py:442    NY:  2025-12-19 20:28:05 (EST/EDT)\nINFO     event_saver:event_saver.py:443    SP:  2025-12-19 22:28:05 (BRT)\nINFO     event_saver:event_saver.py:447    Offset NY vs UTC: -5.0 horas\nINFO     event_saver:event_saver.py:450    Offset SP vs UTC: -3.0 horas\nINFO     event_saver:event_saver.py:424 \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\nINFO     ContextCollector:context_collector.py:132 \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\nINFO     root:liquidity_heatmap.py:77 \u2705 Liquidity Heatmap v2.1.0 inicializado | Janela: 2000 trades | Threshold: 0.300%\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
___________________ TestFullTradingFlow.test_endurance_test ___________________
tests\test_integration_full_flow.py:181: in test_endurance_test
    result = await full_trading_system.process_market_data({
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EnhancedMarketBot' object has no attribute 'process_market_data'
----------------------------- Captured log setup ------------------------------
INFO     root:market_orchestrator.py:151 \u2705 Clock Sync inicializado\nINFO     root:health_monitor.py:55 \u2705 HealthMonitor iniciado. Warning ap\xf3s 90s, Critical ap\xf3s 180s de sil\xeancio.\nINFO     health_monitor:structured_logging.py:33 {"symbol": "SYSTEM", "event": "health_monitor_started", "level": "INFO", "warn_silence": 90, "critical_silence": 180, "check_interval": 30, "oci_enabled": false}\nINFO     EventBus:event_bus.py:581 \u2705 EventBus v2.1.2 iniciado (valida\xe7\xe3o inteligente)\nINFO     event_bus:structured_logging.py:33 {"symbol": "EventBus", "event": "event_bus_started", "level": "INFO", "max_queue_size": 1000, "dedup_window": 30}\nINFO     root:feature_store.py:34 FeatureStore Parquet inicializado em features\nINFO     root:orderbook_analyzer.py:398 \u2705 OrderBook Analyzer v2.1.0 (engine 2.2.0) inicializado | Symbol: BTCUSDT | Alert: 500% | Wall STD: 2.0x | Top N: 20 | Cache TTL: 15.0s | Max Stale: 60.0s | Rate Limit: 10 req/min | Config loaded: \u274c (usando defaults) | History maxlen: 50 | Metrics: \u274c (desabilitadas)\nINFO     event_saver:event_saver.py:352 \u2705 SQLite EventStore inicializado com sucesso\nINFO     event_saver:event_saver.py:440 \U0001f550 Verifica\xe7\xe3o de Timezone:\nINFO     event_saver:event_saver.py:441    UTC: 2025-12-20 01:28:05 UTC\nINFO     event_saver:event_saver.py:442    NY:  2025-12-19 20:28:05 (EST/EDT)\nINFO     event_saver:event_saver.py:443    SP:  2025-12-19 22:28:05 (BRT)\nINFO     event_saver:event_saver.py:447    Offset NY vs UTC: -5.0 horas\nINFO     event_saver:event_saver.py:450    Offset SP vs UTC: -3.0 horas\nINFO     event_saver:event_saver.py:424 \u2705 EventSaver v5.0.0 inicializado | Buffer max: 10000 | Cleanup: 300s | File locking: HABILITADO (msvcrt)\nINFO     ContextCollector:context_collector.py:132 \u2705 ContextCollector inicializado | Symbol: BTCUSDT | Alpha Vantage: ENABLED\nINFO     root:core.py:299 \u2705 FlowAnalyzer v2.4.0 inicializado | Whale threshold: 5.00 BTC | Windows: [1, 5, 15] min | Reset interval: 4.0h | Max trades: 100000 | Time budget: 500.0ms\nINFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_start", "level": "INFO"}
_ TestOrderBookAnalyzerComprehensive.test_initialization_with_invalid_config __
tests\test_orderbook_analyzer_comprehensive.py:479: in test_initialization_with_invalid_config
    OrderBookAnalyzer(None)
orderbook_analyzer\analyzer.py:32: in __init__
    self.symbol = config.symbol
                  ^^^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'symbol'
______ TestOrderBookAnalyzerComprehensive.test_configuration_persistence ______
tests\test_orderbook_analyzer_comprehensive.py:889: in test_configuration_persistence
    config = OrderBookConfig(
E   TypeError: OrderBookConfig.__init__() got an unexpected keyword argument 'max_history_size'
_______________ TestOrderBookComprehensive.test_initialization ________________
tests\test_orderbook_core_comprehensive.py:656: in test_initialization
    assert ob.last_sequence == 0
           ^^^^^^^^^^^^^^^^
E   AttributeError: 'OrderBook' object has no attribute 'last_sequence'
_________ TestOrderBookComprehensive.test_update_with_missing_prices __________
tests\test_orderbook_core_comprehensive.py:729: in test_update_with_missing_prices
    update_bids_only = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
----------------------------- Captured log setup ------------------------------
INFO     ai_analyzer:structured_logging.py:33 {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
INFO     root:ai_runner.py:181 {
  "sentiment": "neutral",
   "confidence": 0.0,
   "action": "wait",
   "rationale": "Falta de dados suficientes para análise confiável, incluindo dados de multi-timeframes, memória de eventos e probabilidade histórica.",
   "entry_zone": null,
   "invalidation_zone": null,
   "region_type": null
}
INFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 301}
------------------------------ Captured log call ------------------------------
INFO     ai_analyzer:structured_logging.py:33 {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
INFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
INFO     ai_analyzer:structured_logging.py:33 {"symbol": "AI", "event": "ai_analyze_ok", "level": "INFO", "mode": "groq", "model": "llama-3.3-70b-versatile", "tipo_evento": "Teste de Conexão", "ativo": "BTCUSDT"}
INFO     ai_runner:structured_logging.py:33 {"symbol": "BTCUSDT", "event": "ai_init_success", "level": "INFO", "test_response_len": 293}
____________ TestOrderBookComprehensive.test_get_spread_edge_cases ____________
tests\test_orderbook_core_comprehensive.py:775: in test_get_spread_edge_cases
    orderbook.update(OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
________________ TestOrderBookComprehensive.test_get_mid_price ________________
tests\test_orderbook_core_comprehensive.py:805: in test_get_mid_price
    orderbook.update(OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
________________ TestOrderBookComprehensive.test_get_imbalance ________________
tests\test_orderbook_core_comprehensive.py:879: in test_get_imbalance
    orderbook.update(OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_________ TestOrderBookComprehensive.test_get_weighted_average_price __________
tests\test_orderbook_core_comprehensive.py:938: in test_get_weighted_average_price
    orderbook.update(OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____________ TestOrderBookComprehensive.test_snapshot_age_check ______________
tests\test_orderbook_core_comprehensive.py:1048: in test_snapshot_age_check
    recent_snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
_________ TestOrderBookComprehensive.test_snapshot_json_serialization _________
tests\test_orderbook_core_comprehensive.py:1075: in test_snapshot_json_serialization
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
_____________ TestOrderBookComprehensive.test_concurrent_updates ______________
tests\test_orderbook_core_comprehensive.py:1181: in test_concurrent_updates
    results.append(future.result())
                   ^^^^^^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
..\..\..\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py:59: in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests\test_orderbook_core_comprehensive.py:1163: in update_task
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____________ TestOrderBookComprehensive.test_performance_benchmark ____________
tests\test_orderbook_core_comprehensive.py:1214: in test_performance_benchmark
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_________ TestOrderBookComprehensive.test_circuit_breaker_integration _________
tests\test_orderbook_core_comprehensive.py:1272: in test_circuit_breaker_integration
    circuit_breaker = CircuitBreaker(
E   TypeError: CircuitBreaker.__init__() got an unexpected keyword argument 'failure_threshold'
_______________ TestOrderBookComprehensive.test_error_handling ________________
tests\test_orderbook_core_comprehensive.py:1329: in test_error_handling
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_________ TestOrderBookComprehensive.test_decimal_precision_handling __________
tests\test_orderbook_core_comprehensive.py:1368: in test_decimal_precision_handling
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
___ TestOrderBookComprehensive.test_validation_edge_cases[50000.0-1.0-True] ___
tests\test_orderbook_core_comprehensive.py:1415: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ TestOrderBookComprehensive.test_validation_edge_cases[1e-06-1.0-True] ____
tests\test_orderbook_core_comprehensive.py:1415: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ TestOrderBookComprehensive.test_validation_edge_cases[50000.0-1e-06-True] __
tests\test_orderbook_core_comprehensive.py:1415: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ TestOrderBookComprehensive.test_validation_edge_cases[0.0-1.0-False] _____
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ TestOrderBookComprehensive.test_validation_edge_cases[50000.0-0.0-False] ___
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ TestOrderBookComprehensive.test_validation_edge_cases[-50000.0-1.0-False] __
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ TestOrderBookComprehensive.test_validation_edge_cases[50000.0--1.0-False] __
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ TestOrderBookComprehensive.test_validation_edge_cases[inf-1.0-False] _____
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ TestOrderBookComprehensive.test_validation_edge_cases[50000.0-inf-False] ___
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____ TestOrderBookComprehensive.test_validation_edge_cases[nan-1.0-False] _____
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__ TestOrderBookComprehensive.test_validation_edge_cases[50000.0-nan-False] ___
tests\test_orderbook_core_comprehensive.py:1425: in test_validation_edge_cases
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
____________ TestOrderBookComprehensive.test_custom_sorting_logic _____________
tests\test_orderbook_core_comprehensive.py:1497: in test_custom_sorting_logic
    orderbook.update(OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
______ TestOrderBookComprehensive.test_order_execution_updates_orderbook ______
tests\test_orderbook_core_comprehensive.py:1737: in test_order_execution_updates_orderbook
    orderbook.update(OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
___________ TestOrderBookComprehensive.test_high_frequency_updates ____________
tests\test_orderbook_core_comprehensive.py:1795: in test_high_frequency_updates
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
__________ TestOrderBookComprehensive.test_thread_safety_stress_test __________
tests\test_orderbook_core_comprehensive.py:1900: in test_thread_safety_stress_test
    assert len(errors) == 0, f"Found {len(errors)} errors in thread-safe operations"
E   AssertionError: Found 737 errors in thread-safe operations
E   assert 737 == 0
E    +  where 737 = len([('snapshot', False, "'OrderBook' object has no attribute 'create_snapshot'"), ('statistics', False, "'OrderBook' object has no attribute 'get_statistics'"), ('snapshot', False, "'OrderBook' object has no attribute 'create_snapshot'"), ('statistics', False, "'OrderBook' object has no attribute 'get_statistics'"), ('statistics', False, "'OrderBook' object has no attribute 'get_statistics'"), ('update', False, "OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'"), ...])
---------------------------- Captured stdout call -----------------------------
Thread safety stress test:
  Total operations: 1000
  Updates: 252
  Reads: 263
  Snapshots: 244
  Statistics: 241
  Errors: 737
Errors encountered:
  ('snapshot', False, "'OrderBook' object has no attribute 'create_snapshot'")
  ('statistics', False, "'OrderBook' object has no attribute 'get_statistics'")
  ('snapshot', False, "'OrderBook' object has no attribute 'create_snapshot'")
  ('statistics', False, "'OrderBook' object has no attribute 'get_statistics'")
  ('statistics', False, "'OrderBook' object has no attribute 'get_statistics'")
_______ TestOrderBookComprehensive.test_robustness_to_malformed_updates _______
tests\test_orderbook_core_comprehensive.py:1970: in test_robustness_to_malformed_updates
    valid_update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
_____ TestOrderBookComprehensive.test_comprehensive_integration_scenario ______
tests\test_orderbook_core_comprehensive.py:1998: in test_comprehensive_integration_scenario
    update = OrderBookUpdate(
E   TypeError: OrderBookUpdate.__init__() got an unexpected keyword argument 'sequence'
---------------------------- Captured stdout call -----------------------------
\n=== Comprehensive Integration Test ===\n\u2713 Phase 1: Initialization complete
__________________________ test_to_float_list_basic ___________________________
tests\test_orderbook_helpers.py:26: in test_to_float_list_basic
    result = oba_mod._to_float_list(data)
             ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'orderbook_analyzer' has no attribute '_to_float_list'
__________________________ test_sum_depth_usd_top_n ___________________________
tests\test_orderbook_helpers.py:32: in test_sum_depth_usd_top_n
    v1 = oba_mod._sum_depth_usd(levels, 1)   # 100 * 1
         ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'orderbook_analyzer' has no attribute '_sum_depth_usd'
____________ TestOrderBookSnapshotValidation.test_snapshot_too_old ____________
tests\test_orderbook_validate_snapshot.py:18: in test_snapshot_too_old
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
_____________ TestOrderBookSnapshotValidation.test_snapshot_fresh _____________
tests\test_orderbook_validate_snapshot.py:39: in test_snapshot_fresh
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
__________ TestOrderBookSnapshotValidation.test_snapshot_validation ___________
tests\test_orderbook_validate_snapshot.py:55: in test_snapshot_validation
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
_______ TestOrderBookSnapshotValidation.test_snapshot_with_invalid_data _______
tests\test_orderbook_validate_snapshot.py:77: in test_snapshot_with_invalid_data
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
_________ TestOrderBookSnapshotValidation.test_snapshot_serialization _________
tests\test_orderbook_validate_snapshot.py:107: in test_snapshot_serialization
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
___________ TestOrderBookSnapshotValidation.test_snapshot_from_json ___________
tests\test_orderbook_validate_snapshot.py:141: in test_snapshot_from_json
    snapshot = OrderBookSnapshot.from_json(json_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: type object 'OrderBookSnapshot' has no attribute 'from_json'
____ TestOrderBookSnapshotValidation.test_snapshot_age_validation[1-True] _____
tests\test_orderbook_validate_snapshot.py:160: in test_snapshot_age_validation
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
____ TestOrderBookSnapshotValidation.test_snapshot_age_validation[3-True] _____
tests\test_orderbook_validate_snapshot.py:160: in test_snapshot_age_validation
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
____ TestOrderBookSnapshotValidation.test_snapshot_age_validation[6-False] ____
tests\test_orderbook_validate_snapshot.py:160: in test_snapshot_age_validation
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
___ TestOrderBookSnapshotValidation.test_snapshot_age_validation[10-False] ____
tests\test_orderbook_validate_snapshot.py:160: in test_snapshot_age_validation
    snapshot = OrderBookSnapshot(
E   TypeError: OrderBookSnapshot.__init__() got an unexpected keyword argument 'sequence'
________ TestPerformanceBenchmarks.test_market_orchestrator_throughput ________
tests\test_performance_benchmarks.py:114: in test_market_orchestrator_throughput
    assert throughput > 100, f"Throughput baixo: {throughput:.0f} msg/sec"
E   AssertionError: Throughput baixo: 65 msg/sec
E   assert 64.5537352348843 > 100
____________ TestPerformanceBenchmarks.test_concurrent_performance ____________
tests\test_performance_benchmarks.py:190: in test_concurrent_performance
    assert throughput > 500, f"Throughput concorrente baixo: {throughput:.0f} msg/sec"
E   AssertionError: Throughput concorrente baixo: 258 msg/sec
E   assert 258.1616945111071 > 500
______________ TestRiskManagerComprehensive.test_remove_position ______________
tests\test_risk_manager_comprehensive.py:124: in test_remove_position
    risk_manager.remove_position('BTCUSDT')
E   TypeError: RiskManager.remove_position() missing 1 required positional argument: 'exit_price'
_______ TestRiskManagerComprehensive.test_check_trade_request_approved ________
tests\test_risk_manager_comprehensive.py:130: in test_check_trade_request_approved
    'BTCUSDT': Position(symbol='BTCUSDT', size=0.2, entry_price=49000, current_price=49500),
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: Position.__init__() missing 1 required positional argument: 'side'
____ TestRiskManagerComprehensive.test_check_trade_request_position_limit _____
tests\test_risk_manager_comprehensive.py:145: in test_check_trade_request_position_limit
    risk_manager.positions[f'SYM{i}'] = Position(
E   TypeError: Position.__init__() missing 1 required positional argument: 'side'
______ TestRiskManagerComprehensive.test_calculate_position_risk_metrics ______
tests\test_risk_manager_comprehensive.py:201: in test_calculate_position_risk_metrics
    assert 'unrealized_pnl' in metrics
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'RiskMetrics' is not iterable
________ TestRiskManagerComprehensive.test_error_handling_and_recovery ________
tests\test_risk_manager_comprehensive.py:524: in test_error_handling_and_recovery
    with pytest.raises(ValueError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.12.8-final-0 _______________

Name                                                  Stmts   Miss Branch BrPart   Cover   Missing
--------------------------------------------------------------------------------------------------
ai_analyzer_disabled.py                                  51     51     12      0   0.00%   3-112
ai_analyzer_qwen.py                                     635    387    192     37  36.64%   64-65, 70, 77-84, 91-92, 97, 107-109, 141, 149, 285-311, 360-363, 369, 390->exit, 394, 424, 436->443, 462, 466-532, 545, 565->568, 571-583, 587-592, 602-607, 636->627, 644, 656, 661-665, 669, 720-724, 758-764, 787-795, 813-816, 832-868, 874-888, 893-939, 972-1123, 1131-1153, 1161, 1163-1164, 1181, 1184, 1189, 1191-1197, 1204-1233, 1237-1262, 1272->1285, 1274-1282, 1286-1287, 1289-1290, 1318-1320, 1324, 1326->1332, 1329-1330, 1334-1336, 1340-1342, 1345, 1351, 1365-1370, 1405, 1421-1434, 1452-1453, 1457, 1464
ai_historical_pro.py                                    545    545    134      0   0.00%   11-1171
ai_runner\__init__.py                                     4      0      0      0 100.00%
ai_runner\ai_runner.py                                  362    236    112     12  29.54%   28, 30, 32, 34, 40-44, 49-50, 54-68, 75, 80-88, 99-100, 109-115, 159-170, 174-196, 200-206, 210-215, 220-221, 230-244, 248-295, 303, 315, 323-324, 328-332, 344-356, 360-367, 372-374, 378, 382-383, 387-388, 392-405, 411-414, 418-422, 430-431, 435-439, 443-454, 458-462, 466, 470, 474-485, 489-499, 510, 519-520, 526->exit, 533-536, 544, 553-557, 561-578, 582, 586-596, 599
ai_runner\exceptions.py                                   4      0      0      0 100.00%
alert_engine.py                                         207    192    108      0   4.76%   37-65, 75-100, 117-273, 280-322, 340-356, 363-400, 407-465, 472-497
audit_new_features.py                                   125    125     60      0   0.00%   1-206
audit_script.py                                          27     27      8      0   0.00%   1-36
clock_sync.py                                            57     25      6      2  53.97%   42-60, 64->exit, 65-69, 78, 82-83, 87-89
config.py                                               190     28     26      0  75.93%   520-585
context_collector.py                                    586    501    164      1  11.47%   52-59, 113->118, 140-147, 151-215, 220-228, 233-267, 270-271, 274-284, 290-309, 314-325, 328-345, 348-359, 362-370, 373-395, 398-405, 410-446, 451-522, 525-567, 570-607, 612-641, 644-677, 682-715, 718-736, 739-775, 781-802, 807-827, 832, 847-861, 864, 867-871, 875, 878-882, 885-887, 890-895, 898-901
create_structure.py                                      48     48     12      0   0.00%   6-107
dashboard.py                                            433    433    188      0   0.00%   2-1084
data_handler.py                                         692    491    214     45  28.92%   86, 90, 95-110, 142, 146->151, 157, 163->152, 174, 183, 208-239, 258, 270, 283, 285, 287, 293, 295, 304-306, 328, 338, 345, 350, 359, 373, 385-387, 403, 413, 419-422, 431-434, 449->451, 451->447, 460-485, 500, 510, 520, 526, 528, 531-533, 550-562, 583-584, 589->593, 620-649, 654-665, 679-727, 743-762, 773, 787, 798-800, 817, 825, 833-835, 846, 854, 862-864, 875, 883, 891-893, 902-914, 919-942, 947-957, 972-973, 977-981, 1013-1333, 1371-1628, 1643, 1655-1665
data_pipeline\__init__.py                                 5      0      0      0 100.00%
data_pipeline\cache\__init__.py                           3      0      0      0 100.00%
data_pipeline\cache\buffer.py                           124     85     32      0  25.00%   54, 63-67, 81-83, 123-138, 156-195, 207-227, 239-271, 283, 295-312, 330-334, 342-344, 348-349
data_pipeline\cache\lru_cache.py                         91     52     18      3  38.53%   32, 36, 40, 44, 118-142, 154-158, 171-172, 177-180, 206-213, 217, 229-232, 244-248, 264-272, 291-295
data_pipeline\config.py                                  32      5      2      0  79.41%   9-10, 49-52
data_pipeline\fallback\__init__.py                        2      0      0      0 100.00%
data_pipeline\fallback\registry.py                       25      3      0      0  88.00%   108, 135-136
data_pipeline\logging_utils.py                           99     38      2      0  62.38%   81-83, 88-90, 100-102, 113-115, 119-121, 125-127, 132-134, 138-140, 144-146, 151-153, 169-171, 209-213
data_pipeline\metrics\__init__.py                         3      0      0      0 100.00%
data_pipeline\metrics\data_quality_metrics.py           104     43     30      6  54.48%   101, 105->109, 109->115, 115->119, 124, 133-134, 138-166, 195-224, 228-229, 233-253, 257-260, 279-280, 312->315
data_pipeline\metrics\processor.py                       57      9     10      5  79.10%   57, 60, 65, 74-75, 92-97, 159-160
data_pipeline\pipeline.py                               246     75     68     21  65.61%   19, 23-24, 84-98, 145-151, 169-177, 212, 220-221, 253-260, 272-278, 290-296, 307-313, 347-348, 395, 399, 435, 444-445, 454->467, 461, 474-480, 487-492, 511, 539->exit, 546, 549, 551->exit, 564->572, 579-580, 598, 628-638, 647->650, 650->653, 653->657, 661-662, 677, 688-709, 713, 719-720
data_pipeline\validation\__init__.py                      3      0      0      0 100.00%
data_pipeline\validation\adaptive.py                     60     34     12      0  36.11%   58-59, 68, 78-87, 99-136, 140, 144-147, 156-165
data_pipeline\validation\validator.py                   124     29     36     11  72.50%   91, 95, 138->147, 185, 194, 202-203, 211-240, 255-256, 261, 287-290, 304, 307->317, 309, 323-328
data_quality_validator.py                                75     75     26      0   0.00%   2-172
data_validator.py                                       497    174    250     47  62.38%   15-16, 88-89, 145, 154, 192->200, 197, 200->188, 221-225, 229-231, 238, 242-243, 256-278, 282-283, 285-286, 290-292, 300-322, 326-328, 342, 356, 370-371, 377->386, 382->386, 406-413, 418-421, 430-433, 439->451, 441->451, 444-445, 467-470, 484-487, 494-497, 505-506, 510-515, 517, 541, 544, 548, 554-555, 577-581, 585-589, 593-596, 599-601, 602->605, 625, 633, 640->647, 642->641, 644->643, 649->648, 661, 715->733, 733->747, 737, 751-766, 774, 786-787, 791, 797-821, 839-907
database\__init__.py                                      0      0      0      0 100.00%
database\event_store.py                                  70     40      6      0  39.47%   33, 79-81, 85, 94-130, 141-151, 155-170
debug_payload.py                                         14     14      0      0   0.00%   1-24
debug_validator.py                                       25     25      4      0   0.00%   2-49
diagnose_crash.py                                        78     78     34      0   0.00%   6-121
dynamic_volume_profile.py                               104     95     34      0   6.52%   15-17, 27-54, 70-172, 188-208
enhanced_market_bot.py                                    0      0      0      0 100.00%
event_bus.py                                            262     91    112     26  61.76%   109, 120-176, 186, 192, 200, 207, 212-213, 215-216, 218-219, 224, 233-237, 254, 266, 270, 317, 322->327, 330, 343-345, 350, 365-368, 371, 379-381, 403-404, 408-426, 430, 436->439, 478, 488-490, 519-528, 554-561, 570, 577->exit, 588, 599, 604-615
event_memory.py                                          22     15     10      0  21.88%   13, 19-22, 29-41
event_saver.py                                          835    701    326     12  12.40%   31-33, 42, 48-51, 58-60, 83-130, 136-137, 142-171, 185-261, 273-311, 316-325, 349->358, 353-355, 394-411, 445->448, 448->exit, 452-458, 468-473, 478, 482-502, 507-536, 540->exit, 541-543, 548-574, 579-597, 602-615, 623-649, 653-721, 725->exit, 729-732, 738-758, 765-869, 874-945, 950-980, 984-1071, 1076-1112, 1116-1125, 1129-1158, 1162-1195, 1199-1228, 1238-1240, 1246-1262
event_stats_model.py                                    238    238     54      0   0.00%   1-371
feature_store.py                                         82     56     22      0  25.00%   38-45, 50-58, 63-72, 82-93, 96-122, 125, 128, 131
fix_duplicatas.py                                        30     30      4      0   0.00%   3-70
fix_playwright.py                                        63     63     20      0   0.00%   2-109
fix_separador_final.py                                   23     23      2      0   0.00%   3-78
fix_timestamp.py                                         15     15      0      0   0.00%   3-47
flow_analyzer.py                                         11     11      0      0   0.00%   13-49
flow_analyzer\__init__.py                                20      4      0      0  80.00%   122-125
flow_analyzer\absorption.py                             154     68     62      9  48.61%   86-89, 107, 113, 117-118, 123->127, 163, 169, 172, 214-217, 233, 237-238, 257-262, 289, 342-398, 424-442, 477-479
flow_analyzer\aggregates.py                             150     14     48      6  87.88%   129, 141-142, 146-149, 153-158, 236, 266, 332
flow_analyzer\constants.py                               50      0      0      0 100.00%
flow_analyzer\core.py                                   598    170    180     47  67.99%   81-83, 89-90, 96-98, 104-106, 160, 164->171, 167-168, 215->233, 229-230, 372-381, 399->402, 404-406, 410-414, 425-433, 447, 486, 508, 513->518, 518->526, 546->558, 554->549, 560-564, 573, 583-585, 600, 612, 655-656, 662-663, 667-700, 706-708, 719, 727, 763->771, 802, 808->814, 810->814, 814->820, 817, 820->826, 822->826, 826->832, 829, 842-844, 848, 870, 897, 911, 919, 934-938, 945, 983-993, 1015-1067, 1076, 1086-1115, 1120, 1133-1136, 1144, 1164, 1211, 1214-1215, 1227, 1270->1273, 1290-1291, 1300, 1321
flow_analyzer\errors.py                                  60     41      4      0  29.69%   34-37, 40-44, 48, 64-70, 77-84, 91-102, 115-132, 139-150, 163-175, 182-189
flow_analyzer\logging_config.py                          67     43     14      0  29.63%   39-41, 50-83, 104-111, 115-119, 130-141, 146, 161-162, 168, 172, 176, 179, 182, 185, 188, 207-212
flow_analyzer\metrics.py                                147     47     40     12  60.96%   101-102, 168-183, 193-194, 198-208, 212-217, 224-229, 239, 325-326, 331-332, 337, 342->348, 345, 348->357, 351-352, 354, 360, 364->370, 367
flow_analyzer\profiling.py                              207    154     28      1  22.98%   29-30, 62-69, 73-83, 87-93, 97-110, 114-124, 140-154, 166-177, 189-203, 207-210, 242-243, 255-286, 290-306, 310-311, 325-329, 334-341, 345-347, 351-359, 374-377, 398-414, 423-427, 432-436, 446-472
flow_analyzer\prometheus_metrics.py                     116     87     30      1  20.55%   19, 25-32, 58-134, 164-178, 184-185, 189-190, 194-195, 199-200, 204-205, 209-210, 214-215, 237-240, 244-245, 249-250, 254-257, 261-264, 268, 277-286, 298-301, 310, 315, 320
flow_analyzer\protocols.py                               74     26      0      0  64.86%   22, 26, 35, 44, 48, 63, 72, 81, 85, 89, 99, 107, 111, 116, 121, 130, 145, 149, 153, 162, 166, 170, 174, 182, 186, 190
flow_analyzer\serialization.py                           60     44     22      0  19.51%   40-64, 83-85, 98-116, 128-137, 141-149, 161, 168
flow_analyzer\utils.py                                  117     46     30      3  57.14%   65-68, 108-111, 143-144, 157-160, 192-216, 248-251, 261-262, 305-306, 310, 317, 325, 328, 364-366
flow_analyzer\validation.py                             168     72     76     15  52.05%   49->exit, 71, 81->80, 84, 111, 113, 115, 124-134, 146-147, 187, 191, 195, 198, 201, 224-248, 280-318, 351, 353-354, 370-384, 418
format_utils.py                                         220    164    132     18  22.16%   19, 24, 27-30, 37-49, 52, 55-56, 68, 74, 79-84, 96, 103-107, 112, 115-116, 128, 135-138, 144, 146, 151-152, 163, 169, 174, 177-178, 188-205, 211-225, 231-238, 245-257, 263-269, 281-311, 323-353, 367-434
full_audit.py                                           101    101     56      0   0.00%   1-155
health_monitor.py                                       105     58     26      6  41.98%   44-48, 69, 80-88, 95->exit, 107-119, 123-135, 140-145, 150-174, 178-184, 192-210
historical_profiler.py                                  113     98     28      0  10.64%   38-74, 78-187, 191-229
infrastructure\__init__.py                                0      0      0      0 100.00%
infrastructure\oci\__init__.py                            0      0      0      0 100.00%
infrastructure\oci\monitoring.py                         53     51     10      0   3.17%   4-111
infrastructure\oci\vault_helper.py                       44     43      8      0   1.92%   3-70
integration_validator.py                                 71     71     30      0   0.00%   9-227
levels_registry.py                                      144     92     44      1  28.19%   43, 59->exit, 64-65, 68-71, 75-78, 95-96, 100-106, 109-116, 120-138, 142-152, 156-172, 177-198, 201
liquidity_heatmap.py                                    220     85     70     17  56.55%   22, 24, 32, 92-93, 96, 106->exit, 126-127, 170, 180-183, 195->199, 202-204, 231, 248-249, 253-260, 264-270, 281-287, 327-328, 332-333, 344-346, 357-364, 370-409, 413-446, 460-474, 478
log_formatter.py                                         69     69     34      0   0.00%   3-195
macro_fetcher.py                                        110    110     38      0   0.00%   2-202
main.py                                                  85     85     22      0   0.00%   14-193
market_analyzer.py                                        3      3      0      0   0.00%   2-11
market_impact.py                                         85     85     48      0   0.00%   2-154
market_orchestrator\__init__.py                           2      0      0      0 100.00%
market_orchestrator\ai\__init__.py                        0      0      0      0 100.00%
market_orchestrator\ai\ai_payload_builder.py             83     79     28      0   3.60%   49-294, 298-300
market_orchestrator\ai\ai_runner.py                     222    168     34      2  21.88%   41-44, 80, 88, 94-95, 120, 127-138, 189-226, 250-573
market_orchestrator\connection\__init__.py                0      0      0      0 100.00%
market_orchestrator\connection\robust_connection.py     180    103     46      0  35.84%   77-85, 162-232, 237-245, 253-274, 278-302, 306-349, 355-363
market_orchestrator\flow\__init__.py                      0      0      0      0 100.00%
market_orchestrator\flow\risk_manager.py                 32     21      6      0  28.95%   10-18, 22-44, 55, 59-60, 64, 68, 82-83, 87-88
market_orchestrator\flow\signal_processor.py             29     21      4      0  24.24%   10-12, 16-37, 41-45, 49, 58-59
market_orchestrator\flow\trade_executor.py               21     12      2      0  39.13%   10-12, 16-29, 33, 42, 51, 55
market_orchestrator\flow\trade_flow_analyzer.py          13      0      2      0 100.00%
market_orchestrator\market_orchestrator.py              873    539    264     39  34.21%   32-34, 80-81, 91-92, 148->155, 152-153, 280-281, 290-291, 297-298, 314-315, 331-341, 351-357, 364-480, 486, 490, 501-534, 541, 547-700, 706, 722, 738, 744-777, 783-803, 809-819, 829-885, 900-933, 936-980, 1011->1014, 1014->1019, 1019->1024, 1034->1037, 1043->1057, 1045->1051, 1050, 1055, 1061-1062, 1065->1069, 1069->1076, 1073, 1082, 1084, 1087->1164, 1090->1092, 1092->1094, 1094->1096, 1096->1100, 1100->1106, 1102->1106, 1107->1117, 1111, 1113, 1142, 1146, 1149-1154, 1161-1162, 1165-1174, 1190->1193, 1205, 1221-1263, 1273-1310, 1315-1376, 1388->1391, 1397->1400, 1400->1427, 1408-1409, 1411->1427, 1419-1425, 1429->exit, 1437, 1443-1476, 1479-1509, 1513-1524, 1537-1576, 1582, 1597-1607, 1616-1617, 1632->1637, 1634-1635, 1707-1711, 1717-1723, 1727-1728, 1739-1775
market_orchestrator\orchestrator.py                      59     36     14      0  31.51%   22-27, 34-39, 43-49, 58-63, 67, 77-78, 82-96, 100-104
market_orchestrator\orderbook\__init__.py                 0      0      0      0 100.00%
market_orchestrator\orderbook\orderbook_wrapper.py      147     77     32      4  44.69%   47-137, 178, 183-194, 202-237, 288, 312-314, 321, 358-360, 367
market_orchestrator\signals\__init__.py                   0      0      0      0 100.00%
market_orchestrator\signals\signal_processor.py          72     59     28      0  13.00%   31-32, 56-222
market_orchestrator\utils\__init__.py                     0      0      0      0 100.00%
market_orchestrator\utils\logging_utils.py               18      0      2      0 100.00%
market_orchestrator\utils\price_fetcher.py               26     11      6      1  50.00%   36-57
market_orchestrator\windows\__init__.py                   0      0      0      0 100.00%
market_orchestrator\windows\window_processor.py         158     62     44     12  57.43%   36-37, 51-52, 62->61, 68-69, 93-94, 111-121, 127->130, 131->138, 150, 156-177, 191-200, 222-227, 253-254, 292-293, 298->307, 301-302, 308-315, 340->352, 343-344, 367-381, 385->389, 387-388
ml\hybrid_decision.py                                   131     90     30      0  25.47%   40-45, 68-73, 115-128, 163-209, 229, 260-296, 325-379, 394-410, 427-429, 437
ml\inference_engine.py                                   96     34     26      9  59.84%   33, 37->45, 46-52, 59-61, 75->84, 86, 102-106, 114-121, 132, 139, 148, 152-159, 185-187, 191-199
ml\model_inference.py                                    75     37     14      2  44.94%   37, 43-47, 54, 64, 72-81, 96, 105-112, 126-146, 168-178
ml_features.py                                          222     76     68     25  60.34%   39, 42->41, 46, 53, 66, 74, 78->83, 79->78, 86, 95-111, 138, 142, 146, 174, 182->190, 212, 219, 244, 259, 294-305, 310-312, 322-340, 357-359, 367-376, 382-386, 399-401, 422, 438-440, 476-479, 485-488, 498-501
orderbook_analyzer.py                                  1089    434    336     87  57.26%   62-63, 96, 152, 163-166, 177, 183-185, 196, 232->239, 436-439, 445-448, 452, 459, 461, 463, 476-485, 494-500, 509, 516-517, 526-547, 573-574, 577-578, 608-609, 614-615, 618->621, 622->628, 624->622, 633-634, 641-642, 652-653, 656-657, 667, 672-673, 681-682, 693-696, 707-721, 734->738, 748-750, 755-760, 764, 768-814, 819-821, 835, 841-842, 844, 870-1148, 1158, 1174, 1199-1202, 1206, 1224->1227, 1231, 1239->1238, 1242->1241, 1247, 1264, 1270, 1280-1284, 1333, 1338, 1351-1352, 1366, 1393, 1408->1407, 1415, 1420, 1457, 1474, 1516, 1557->1562, 1559->1557, 1565-1567, 1589->1594, 1591->1589, 1595, 1615, 1618->1624, 1621-1622, 1680->1683, 1690-1691, 1695->1700, 1697, 1714->1720, 1717, 1723, 1743, 1747->1756, 1749->1756, 1756->1769, 1759->1764, 1761, 1766-1767, 1787, 1789, 1793->1796, 1798, 1800, 1802, 1806->1812, 1810, 1850, 1852, 1867, 1878, 1886->1889, 1901-1903, 1935, 1940, 2083->2087, 2102, 2126-2127, 2130, 2142->exit, 2145-2151, 2164, 2207-2229, 2236-2238, 2248-2249, 2256-2257, 2264-2265, 2273-2349
orderbook_analyzer\__init__.py                           10      0      0      0 100.00%
orderbook_analyzer\analyzer.py                          250    207     84      0  12.87%   19-24, 46-77, 81-84, 95-110, 119-134, 139, 148-169, 178-193, 202-223, 231-269, 280-296, 306-325, 332-367, 377-414, 424-425, 429-431, 435-436, 440, 448-452, 456-470
orderbook_analyzer\config\__init__.py                     0      0      0      0 100.00%
orderbook_analyzer\config\settings.py                    22      5      6      1  78.57%   22, 46-52
orderbook_core\__init__.py                                9      0      0      0 100.00%
orderbook_core\circuit_breaker.py                        92      9     30      4  87.70%   62->66, 72, 77-80, 113-120, 132->exit
orderbook_core\constants.py                              15      0      0      0 100.00%
orderbook_core\event_factory.py                          17      0      0      0 100.00%
orderbook_core\exceptions.py                              4      0      0      0 100.00%
orderbook_core\metrics.py                               100     32     18      7  63.56%   15-17, 25, 28, 69->72, 77-137, 151-152, 160, 163, 166, 170-171, 182->184, 184->186, 186->188, 188->exit, 203-205, 208-209, 212-215
orderbook_core\orderbook.py                             243    139     94      5  35.31%   19->exit, 34-35, 49-50, 78-88, 92, 96, 100, 104, 108, 140, 160->157, 171->168, 182-226, 242, 247-252, 256-263, 267, 271, 275-280, 284, 294-299, 303-349, 361-382, 386-391, 395-404, 408, 412, 416-420
orderbook_core\orderbook_config.py                       22      0      0      0 100.00%
orderbook_core\protocols.py                              34      0     12      6  86.96%   13->exit, 15->exit, 28->exit, 36->exit, 38->exit, 40->exit
orderbook_core\structured_logging.py                     14      0      0      0 100.00%
orderbook_core\tracing_utils.py                          37     15      6      2  55.81%   13-14, 41-44, 63-80
pattern_recognition.py                                   47     41     14      0   9.84%   11-14, 44-81, 100-111
report_generator.py                                     234    222     76      0   3.87%   34-39, 62-93, 122-460, 487-509, 526-578, 591-617
reproduce_issue.py                                       12     12      2      0   0.00%   2-29
risk_management\__init__.py                               0      0      0      0 100.00%
risk_management\exceptions.py                             4      0      0      0 100.00%
risk_management\risk_manager.py                         306     33     96     34  82.34%   135, 151, 185, 194, 206->212, 210, 212->219, 216, 220->224, 238, 261, 278, 289->288, 309, 316, 322, 336, 348, 372, 392, 402, 441->440, 463, 523, 526-529, 548->563, 550->549, 582, 588, 594, 626-628, 632-633, 635-636, 684
show_problem_lines.py                                    28     28     14      0   0.00%   4-36
support_resistance\__init__.py                           30     16      2      0  43.75%   21-34, 43, 47
support_resistance\config.py                             98     31     26      0  57.26%   22-40, 128-131, 144-159, 164-170
support_resistance\constants.py                         110      3      4      2  95.61%   15, 20, 35
support_resistance\core.py                              236    151     82     15  32.08%   34, 46, 64, 128-146, 159, 187, 200-223, 239-328, 333-354, 372-420, 433-462, 471-473, 490-491, 504-506, 523-524, 537-542, 585-607, 623-632, 636
support_resistance\monitor.py                           167     33     68     18  74.89%   135-136, 141-142, 178, 182, 195, 201, 203, 205, 207, 212-214, 223, 240, 243, 250, 252, 254, 256, 275-278, 281-284, 304, 335-341
support_resistance\pivot_points.py                      151     23     48     14  81.41%   45, 51->75, 75->93, 93->107, 107->124, 162, 165, 168-177, 214-225, 249, 258, 264->263, 273->256, 277->275, 282
support_resistance\system.py                            205    102     66      4  43.17%   171-356, 400, 446, 476, 526-528, 537-539, 559-561, 569-582
support_resistance\utils.py                             228     73     80     13  61.04%   49->exit, 96, 137, 159, 167, 214, 227, 254-259, 279, 288->294, 292, 297, 325->328, 348, 353, 388-439, 464-519
support_resistance\validation.py                         70      8     38     10  83.33%   34, 37, 44->51, 85, 94, 98-99, 116->115, 119, 135->142, 138
support_resistance\volume_profile.py                    103      8     28      8  87.79%   50, 70, 75, 79, 91->97, 199, 255, 264, 281
technical_indicators.py                                  73     73      4      0   0.00%   1-120
test_circuit_breaker_integration.py                      25     25      4      0   0.00%   5-45
test_feature_store.py                                   212    212     54      0   0.00%   7-600
test_new_payload.py                                      24     24      0      0   0.00%   1-88
teste_separador.py                                       31     31      8      0   0.00%   3-59
time_manager.py                                         496    249    116     22  45.92%   17-23, 141->164, 151-162, 165-179, 209-213, 231-239, 256, 262-274, 278->285, 305, 318-319, 337, 340-356, 359-370, 376-388, 392-403, 424-428, 435-436, 452-515, 525-526, 533-535, 543-545, 553-562, 573-575, 579, 583, 587, 595-598, 610, 617->621, 628, 637-646, 654-682, 689, 695-700, 709-747, 752-757, 762-783, 825, 830, 844->848
--------------------------------------------------------------------------------------------------
TOTAL                                                 18106  10801   5496    710  36.66%
Coverage HTML written to dir coverage_html
FAIL Required test coverage of 65% not reached. Total coverage: 36.66%
=========================== short test summary info ===========================
FAILED tests/test_ai_runner.py::TestAIRunner::test_ai_runner_parse_response
FAILED tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_batch_analysis
FAILED tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_streaming_analysis
FAILED tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_cache_mechanism
FAILED tests/test_ai_runner_comprehensive.py::TestAIRunnerComprehensive::test_switch_model
FAILED tests/test_integration_full_flow.py::TestFullTradingFlow::test_complete_trade_signal_flow
FAILED tests/test_integration_full_flow.py::TestFullTradingFlow::test_flow_with_risk_rejection
FAILED tests/test_integration_full_flow.py::TestFullTradingFlow::test_flow_with_execution_failure
FAILED tests/test_integration_full_flow.py::TestFullTradingFlow::test_concurrent_market_data_processing
FAILED tests/test_integration_full_flow.py::TestFullTradingFlow::test_system_health_monitoring
FAILED tests/test_integration_full_flow.py::TestFullTradingFlow::test_endurance_test
FAILED tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_initialization_with_invalid_config
FAILED tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_configuration_persistence
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_initialization
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_update_with_missing_prices
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_spread_edge_cases
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_mid_price
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_imbalance
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_weighted_average_price
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_age_check
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_json_serialization
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_concurrent_updates
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_performance_benchmark
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_circuit_breaker_integration
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_error_handling
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_decimal_precision_handling
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-1.0-True]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[1e-06-1.0-True]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-1e-06-True]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[0.0-1.0-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-0.0-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[-50000.0-1.0-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0--1.0-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[inf-1.0-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-inf-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[nan-1.0-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_validation_edge_cases[50000.0-nan-False]
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_custom_sorting_logic
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_order_execution_updates_orderbook
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_high_frequency_updates
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_thread_safety_stress_test
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_robustness_to_malformed_updates
FAILED tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_comprehensive_integration_scenario
FAILED tests/test_orderbook_helpers.py::test_to_float_list_basic - AttributeE...
FAILED tests/test_orderbook_helpers.py::test_sum_depth_usd_top_n - AttributeE...
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_too_old
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_fresh
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_validation
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_with_invalid_data
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_serialization
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_from_json
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[1-True]
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[3-True]
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[6-False]
FAILED tests/test_orderbook_validate_snapshot.py::TestOrderBookSnapshotValidation::test_snapshot_age_validation[10-False]
FAILED tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_market_orchestrator_throughput
FAILED tests/test_performance_benchmarks.py::TestPerformanceBenchmarks::test_concurrent_performance
FAILED tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_remove_position
FAILED tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_approved
FAILED tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_check_trade_request_position_limit
FAILED tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_calculate_position_risk_metrics
FAILED tests/test_risk_manager_comprehensive.py::TestRiskManagerComprehensive::test_error_handling_and_recovery
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_initialization
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_start_and_stop
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_success
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_without_ai
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_with_ai_error
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_orchestrator_not_running
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_with_exception
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_success
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_risk_rejection
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_cooldown_active
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_execution_failure
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_with_exception
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_execute_trade_flow_orchestrator_not_running
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_add_position
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_add_position_duplicate
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_update_position
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_update_position_with_risk_manager
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_remove_position
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_remove_position_without_exit_price
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_portfolio_summary
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_portfolio_summary_empty
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_can_execute_trade
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_cooldown_remaining
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_check_position_limits
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_check_daily_loss_limit
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_error_state_detection
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_error_recovery
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_get_performance_metrics
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_update_configuration
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_serialize_state
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_deserialize_state
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_serialize_deserialize_roundtrip
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_stream
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_process_market_data_stream_stopped
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_emergency_stop
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_emergency_stop_no_positions
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_emergency_stop_with_trade_executor_error
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check_missing_critical_components
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check_missing_non_critical_components
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_health_check_not_running
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_generate_analytics_report
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_generate_analytics_report_no_trades
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_generate_analytics_report_with_filtering
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_memory_usage
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_concurrent_trade_requests
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_concurrent_market_data_processing
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_integration_scenario_complete_trading_cycle
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_integration_scenario_error_recovery
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_stress_test_high_frequency_updates
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_stress_test_memory_usage_with_many_positions
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_empty_market_data
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_invalid_trade_signal
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_extreme_values
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_edge_case_unicode_symbols
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_robustness_against_none_values
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_robustness_against_type_errors
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_performance_large_portfolio_operations
ERROR tests/test_market_orchestrator_comprehensive.py::TestMarketOrchestratorComprehensive::test_performance_many_trade_history_operations
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_process_orderbook_update_success
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_process_orderbook_update_with_malformed_data
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_calculate_metrics_basic
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_calculate_advanced_metrics
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_analyze_with_ai_success
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_analyze_with_ai_failure
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_detect_market_manipulation
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_volume_profile_analysis
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_order_flow_analysis
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_market_depth_analysis
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_technical_indicators
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_calculate_position_risk
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_detect_market_regime
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_generate_trading_signal
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_benchmark_performance
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_async_analysis
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_error_handling_and_recovery
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_memory_management
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_serialization_deserialization
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[0.8-STRONG_BUY]
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[0.6-BUY]
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[0.2-NEUTRAL]
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[-0.2-NEUTRAL]
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[-0.6-SELL]
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_imbalance_based_signals[-0.8-STRONG_SELL]
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_concurrent_access_safety
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_edge_cases_and_boundary_conditions
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_metric_history_tracking
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_price_history_accuracy
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_analyzer_lifecycle
ERROR tests/test_orderbook_analyzer_comprehensive.py::TestOrderBookAnalyzerComprehensive::test_comprehensive_integration
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_update_with_valid_data
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_update_with_invalid_sequence
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_best_bid_ask
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_volume_at_price
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_total_volume
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_price_levels
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_creation
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_snapshot_validation
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_reset_orderbook
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_max_depth_enforcement
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_memory_efficiency
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_state_consistency_after_errors
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_cleanup_old_orders
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_get_statistics_comprehensive
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_liquidity_profile_analysis
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_market_impact_analysis
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_order_simulation
ERROR tests/test_orderbook_core_comprehensive.py::TestOrderBookComprehensive::test_memory_cleanup_on_reset
====== 62 failed, 295 passed, 1 skipped, 108 errors in 115.32s (0:01:55) ======
